[2021-01-27 14:23:10,248 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 14:23:11,309 INFO]  * src vocab size = 48887
[2021-01-27 14:23:11,309 INFO]  * tgt vocab size = 47030
[2021-01-27 14:23:11,309 INFO] Building model...
[2021-01-27 14:23:19,237 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(48887, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(47030, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=512, out_features=47030, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2021-01-27 14:23:19,240 INFO] encoder: 43945472
[2021-01-27 14:23:19,241 INFO] decoder: 73430966
[2021-01-27 14:23:19,241 INFO] * number of parameters: 117376438
[2021-01-27 14:23:19,244 INFO] Starting training on GPU: [0, 1, 2]
[2021-01-27 14:23:19,244 INFO] Start training loop and validate every 500 steps...
[2021-01-27 14:23:25,175 INFO] number of examples: 892901
[2021-01-27 14:25:51,666 INFO] Step 100/202000; acc:   5.25; ppl: 3551.86; xent: 8.18; lr: 0.00010; 21583/21555 tok/s;    152 sec
[2021-01-27 14:28:00,651 INFO] Step 200/202000; acc:   8.95; ppl: 309.95; xent: 5.74; lr: 0.00020; 25566/25523 tok/s;    281 sec
[2021-01-27 14:30:09,702 INFO] Step 300/202000; acc:  16.83; ppl: 160.96; xent: 5.08; lr: 0.00030; 25566/25455 tok/s;    410 sec
[2021-01-27 14:32:18,197 INFO] Step 400/202000; acc:  22.15; ppl: 96.93; xent: 4.57; lr: 0.00040; 25645/25363 tok/s;    539 sec
[2021-01-27 14:34:27,398 INFO] Step 500/202000; acc:  25.71; ppl: 69.66; xent: 4.24; lr: 0.00050; 25564/25547 tok/s;    668 sec
[2021-01-27 14:34:27,399 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 14:34:27,439 INFO] number of examples: 5006
[2021-01-27 14:34:34,514 INFO] Validation perplexity: 100.344
[2021-01-27 14:34:34,514 INFO] Validation accuracy: 28.3313
[2021-01-27 14:34:34,514 INFO] Model is improving acc: -inf --> 28.3313.
[2021-01-27 14:34:34,514 INFO] Model is improving ppl: inf --> 100.344.
[2021-01-27 14:34:34,745 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_500.pt
[2021-01-27 14:35:20,976 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 14:35:28,546 INFO] number of examples: 421684
[2021-01-27 14:36:45,767 INFO] Step 600/202000; acc:  30.02; ppl: 49.79; xent: 3.91; lr: 0.00059; 23619/23460 tok/s;    807 sec
[2021-01-27 14:38:54,665 INFO] Step 700/202000; acc:  36.01; ppl: 33.66; xent: 3.52; lr: 0.00069; 25477/25298 tok/s;    935 sec
[2021-01-27 14:41:04,039 INFO] Step 800/202000; acc:  41.87; ppl: 23.13; xent: 3.14; lr: 0.00079; 25504/25249 tok/s;   1065 sec
[2021-01-27 14:42:08,801 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 14:42:30,614 INFO] number of examples: 892901
[2021-01-27 14:43:13,317 INFO] Step 900/202000; acc:  48.30; ppl: 15.30; xent: 2.73; lr: 0.00089; 25467/25374 tok/s;   1194 sec
[2021-01-27 14:45:22,167 INFO] Step 1000/202000; acc:  52.47; ppl: 11.46; xent: 2.44; lr: 0.00099; 25277/25321 tok/s;   1323 sec
[2021-01-27 14:45:22,168 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 14:45:22,261 INFO] number of examples: 5006
[2021-01-27 14:45:29,318 INFO] Validation perplexity: 12.2465
[2021-01-27 14:45:29,318 INFO] Validation accuracy: 56.5644
[2021-01-27 14:45:29,318 INFO] Model is improving acc: 28.3313 --> 56.5644.
[2021-01-27 14:45:29,318 INFO] Model is improving ppl: 100.344 --> 12.2465.
[2021-01-27 14:45:29,548 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_1000.pt
[2021-01-27 14:47:39,469 INFO] Step 1100/202000; acc:  55.63; ppl:  9.30; xent: 2.23; lr: 0.00109; 23942/23950 tok/s;   1460 sec
[2021-01-27 14:49:48,590 INFO] Step 1200/202000; acc:  57.82; ppl:  8.00; xent: 2.08; lr: 0.00119; 25563/25552 tok/s;   1589 sec
[2021-01-27 14:51:57,050 INFO] Step 1300/202000; acc:  59.74; ppl:  7.07; xent: 1.96; lr: 0.00129; 25675/25455 tok/s;   1718 sec
[2021-01-27 14:54:05,664 INFO] Step 1400/202000; acc:  60.58; ppl:  6.65; xent: 1.89; lr: 0.00138; 25674/25378 tok/s;   1846 sec
[2021-01-27 14:56:15,075 INFO] Step 1500/202000; acc:  61.88; ppl:  6.09; xent: 1.81; lr: 0.00148; 25445/25446 tok/s;   1976 sec
[2021-01-27 14:56:15,075 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 14:56:15,116 INFO] number of examples: 5006
[2021-01-27 14:56:22,211 INFO] Validation perplexity: 6.6403
[2021-01-27 14:56:22,211 INFO] Validation accuracy: 64.1416
[2021-01-27 14:56:22,211 INFO] Model is improving acc: 56.5644 --> 64.1416.
[2021-01-27 14:56:22,211 INFO] Model is improving ppl: 12.2465 --> 6.6403.
[2021-01-27 14:56:22,442 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_1500.pt
[2021-01-27 14:56:47,786 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 14:56:56,882 INFO] number of examples: 421684
[2021-01-27 14:58:32,723 INFO] Step 1600/202000; acc:  62.58; ppl:  5.79; xent: 1.76; lr: 0.00158; 23685/23586 tok/s;   2113 sec
[2021-01-27 15:00:41,911 INFO] Step 1700/202000; acc:  63.36; ppl:  5.49; xent: 1.70; lr: 0.00168; 25531/25365 tok/s;   2243 sec
[2021-01-27 15:02:50,845 INFO] Step 1800/202000; acc:  63.80; ppl:  5.35; xent: 1.68; lr: 0.00178; 25558/25305 tok/s;   2372 sec
[2021-01-27 15:03:35,234 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 15:03:57,327 INFO] number of examples: 892901
[2021-01-27 15:05:00,095 INFO] Step 1900/202000; acc:  64.73; ppl:  5.04; xent: 1.62; lr: 0.00188; 25314/25285 tok/s;   2501 sec
[2021-01-27 15:07:08,576 INFO] Step 2000/202000; acc:  64.90; ppl:  4.94; xent: 1.60; lr: 0.00198; 25519/25517 tok/s;   2629 sec
[2021-01-27 15:07:08,577 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 15:07:08,617 INFO] number of examples: 5006
[2021-01-27 15:07:15,678 INFO] Validation perplexity: 5.4283
[2021-01-27 15:07:15,678 INFO] Validation accuracy: 66.909
[2021-01-27 15:07:15,678 INFO] Model is improving acc: 64.1416 --> 66.909.
[2021-01-27 15:07:15,678 INFO] Model is improving ppl: 6.6403 --> 5.4283.
[2021-01-27 15:07:15,903 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_2000.pt
[2021-01-27 15:09:26,015 INFO] Step 2100/202000; acc:  65.35; ppl:  4.79; xent: 1.57; lr: 0.00193; 23926/23910 tok/s;   2767 sec
[2021-01-27 15:11:34,976 INFO] Step 2200/202000; acc:  66.10; ppl:  4.56; xent: 1.52; lr: 0.00188; 25631/25532 tok/s;   2896 sec
[2021-01-27 15:13:43,343 INFO] Step 2300/202000; acc:  66.96; ppl:  4.34; xent: 1.47; lr: 0.00184; 25599/25454 tok/s;   3024 sec
[2021-01-27 15:15:52,196 INFO] Step 2400/202000; acc:  67.06; ppl:  4.30; xent: 1.46; lr: 0.00180; 25664/25402 tok/s;   3153 sec
[2021-01-27 15:18:02,041 INFO] Step 2500/202000; acc:  67.80; ppl:  4.10; xent: 1.41; lr: 0.00177; 25349/25324 tok/s;   3283 sec
[2021-01-27 15:18:02,042 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 15:18:02,128 INFO] number of examples: 5006
[2021-01-27 15:18:09,180 INFO] Validation perplexity: 4.57981
[2021-01-27 15:18:09,181 INFO] Validation accuracy: 69.2996
[2021-01-27 15:18:09,181 INFO] Model is improving acc: 66.909 --> 69.2996.
[2021-01-27 15:18:09,181 INFO] Model is improving ppl: 5.4283 --> 4.57981.
[2021-01-27 15:18:09,407 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_2500.pt
[2021-01-27 15:18:14,690 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 15:18:26,662 INFO] number of examples: 421684
[2021-01-27 15:20:19,064 INFO] Step 2600/202000; acc:  68.02; ppl:  4.04; xent: 1.40; lr: 0.00173; 23800/23633 tok/s;   3420 sec
[2021-01-27 15:22:28,722 INFO] Step 2700/202000; acc:  68.55; ppl:  3.90; xent: 1.36; lr: 0.00170; 25436/25345 tok/s;   3549 sec
[2021-01-27 15:24:37,385 INFO] Step 2800/202000; acc:  68.66; ppl:  3.88; xent: 1.35; lr: 0.00167; 25615/25375 tok/s;   3678 sec
[2021-01-27 15:25:01,027 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 15:25:23,090 INFO] number of examples: 892901
[2021-01-27 15:26:46,464 INFO] Step 2900/202000; acc:  69.11; ppl:  3.77; xent: 1.33; lr: 0.00164; 25287/25309 tok/s;   3807 sec
[2021-01-27 15:28:55,632 INFO] Step 3000/202000; acc:  69.26; ppl:  3.71; xent: 1.31; lr: 0.00161; 25490/25407 tok/s;   3936 sec
[2021-01-27 15:28:55,633 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 15:28:55,673 INFO] number of examples: 5006
[2021-01-27 15:29:02,757 INFO] Validation perplexity: 4.22493
[2021-01-27 15:29:02,757 INFO] Validation accuracy: 70.4815
[2021-01-27 15:29:02,757 INFO] Model is improving acc: 69.2996 --> 70.4815.
[2021-01-27 15:29:02,757 INFO] Model is improving ppl: 4.57981 --> 4.22493.
[2021-01-27 15:29:02,985 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_3000.pt
[2021-01-27 15:31:13,164 INFO] Step 3100/202000; acc:  69.32; ppl:  3.70; xent: 1.31; lr: 0.00159; 23892/23868 tok/s;   4074 sec
[2021-01-27 15:33:21,925 INFO] Step 3200/202000; acc:  69.80; ppl:  3.59; xent: 1.28; lr: 0.00156; 25647/25528 tok/s;   4203 sec
[2021-01-27 15:35:30,597 INFO] Step 3300/202000; acc:  70.08; ppl:  3.54; xent: 1.26; lr: 0.00154; 25565/25443 tok/s;   4331 sec
[2021-01-27 15:37:40,024 INFO] Step 3400/202000; acc:  70.04; ppl:  3.54; xent: 1.26; lr: 0.00152; 25573/25314 tok/s;   4461 sec
[2021-01-27 15:39:33,376 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 15:39:45,284 INFO] number of examples: 421684
[2021-01-27 15:39:49,543 INFO] Step 3500/202000; acc:  70.50; ppl:  3.45; xent: 1.24; lr: 0.00149; 25348/25328 tok/s;   4590 sec
[2021-01-27 15:39:49,544 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 15:39:49,633 INFO] number of examples: 5006
[2021-01-27 15:39:56,798 INFO] Validation perplexity: 3.96825
[2021-01-27 15:39:56,798 INFO] Validation accuracy: 71.3422
[2021-01-27 15:39:56,798 INFO] Model is improving acc: 70.4815 --> 71.3422.
[2021-01-27 15:39:56,798 INFO] Model is improving ppl: 4.22493 --> 3.96825.
[2021-01-27 15:39:57,025 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_3500.pt
[2021-01-27 15:42:07,064 INFO] Step 3600/202000; acc:  70.42; ppl:  3.45; xent: 1.24; lr: 0.00147; 23676/23517 tok/s;   4728 sec
[2021-01-27 15:44:16,291 INFO] Step 3700/202000; acc:  70.86; ppl:  3.36; xent: 1.21; lr: 0.00145; 25659/25435 tok/s;   4857 sec
[2021-01-27 15:46:25,292 INFO] Step 3800/202000; acc:  70.82; ppl:  3.37; xent: 1.21; lr: 0.00143; 25466/25380 tok/s;   4986 sec
[2021-01-27 15:46:29,395 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 15:46:51,367 INFO] number of examples: 892901
[2021-01-27 15:48:34,333 INFO] Step 3900/202000; acc:  71.07; ppl:  3.32; xent: 1.20; lr: 0.00142; 25277/25277 tok/s;   5115 sec
[2021-01-27 15:50:43,473 INFO] Step 4000/202000; acc:  71.15; ppl:  3.29; xent: 1.19; lr: 0.00140; 25506/25491 tok/s;   5244 sec
[2021-01-27 15:50:43,474 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 15:50:43,514 INFO] number of examples: 5006
[2021-01-27 15:50:50,603 INFO] Validation perplexity: 3.82259
[2021-01-27 15:50:50,603 INFO] Validation accuracy: 71.9988
[2021-01-27 15:50:50,603 INFO] Model is improving acc: 71.3422 --> 71.9988.
[2021-01-27 15:50:50,603 INFO] Model is improving ppl: 3.96825 --> 3.82259.
[2021-01-27 15:50:50,831 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_4000.pt
[2021-01-27 15:53:01,417 INFO] Step 4100/202000; acc:  71.13; ppl:  3.29; xent: 1.19; lr: 0.00138; 23840/23780 tok/s;   5382 sec
[2021-01-27 15:55:10,141 INFO] Step 4200/202000; acc:  71.45; ppl:  3.23; xent: 1.17; lr: 0.00136; 25673/25495 tok/s;   5511 sec
[2021-01-27 15:57:18,656 INFO] Step 4300/202000; acc:  71.71; ppl:  3.19; xent: 1.16; lr: 0.00135; 25581/25414 tok/s;   5639 sec
[2021-01-27 15:59:27,571 INFO] Step 4400/202000; acc:  71.62; ppl:  3.20; xent: 1.16; lr: 0.00133; 25699/25508 tok/s;   5768 sec
[2021-01-27 16:00:59,734 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 16:01:14,063 INFO] number of examples: 421684
[2021-01-27 16:01:37,062 INFO] Step 4500/202000; acc:  71.97; ppl:  3.14; xent: 1.14; lr: 0.00132; 25265/25265 tok/s;   5898 sec
[2021-01-27 16:01:37,063 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:01:37,156 INFO] number of examples: 5006
[2021-01-27 16:01:44,209 INFO] Validation perplexity: 3.71172
[2021-01-27 16:01:44,209 INFO] Validation accuracy: 72.3629
[2021-01-27 16:01:44,209 INFO] Model is improving acc: 71.9988 --> 72.3629.
[2021-01-27 16:01:44,209 INFO] Model is improving ppl: 3.82259 --> 3.71172.
[2021-01-27 16:01:44,436 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_4500.pt
[2021-01-27 16:03:54,631 INFO] Step 4600/202000; acc:  71.82; ppl:  3.16; xent: 1.15; lr: 0.00130; 23763/23549 tok/s;   6035 sec
[2021-01-27 16:06:03,780 INFO] Step 4700/202000; acc:  72.30; ppl:  3.08; xent: 1.12; lr: 0.00129; 25593/25323 tok/s;   6165 sec
[2021-01-27 16:07:56,685 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 16:08:13,216 INFO] Step 4800/202000; acc:  72.17; ppl:  3.09; xent: 1.13; lr: 0.00128; 25416/25380 tok/s;   6294 sec
[2021-01-27 16:08:17,130 INFO] number of examples: 892901
[2021-01-27 16:10:22,322 INFO] Step 4900/202000; acc:  72.27; ppl:  3.08; xent: 1.12; lr: 0.00126; 25232/25298 tok/s;   6423 sec
[2021-01-27 16:12:31,072 INFO] Step 5000/202000; acc:  72.35; ppl:  3.05; xent: 1.12; lr: 0.00125; 25623/25512 tok/s;   6552 sec
[2021-01-27 16:12:31,073 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:12:31,114 INFO] number of examples: 5006
[2021-01-27 16:12:38,227 INFO] Validation perplexity: 3.61482
[2021-01-27 16:12:38,227 INFO] Validation accuracy: 72.8218
[2021-01-27 16:12:38,227 INFO] Model is improving acc: 72.3629 --> 72.8218.
[2021-01-27 16:12:38,227 INFO] Model is improving ppl: 3.71172 --> 3.61482.
[2021-01-27 16:12:38,453 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_5000.pt
[2021-01-27 16:14:48,918 INFO] Step 5100/202000; acc:  72.30; ppl:  3.06; xent: 1.12; lr: 0.00124; 23851/23863 tok/s;   6690 sec
[2021-01-27 16:16:58,343 INFO] Step 5200/202000; acc:  72.72; ppl:  2.99; xent: 1.10; lr: 0.00123; 25526/25376 tok/s;   6819 sec
[2021-01-27 16:19:07,167 INFO] Step 5300/202000; acc:  72.81; ppl:  2.98; xent: 1.09; lr: 0.00121; 25535/25330 tok/s;   6948 sec
[2021-01-27 16:21:16,384 INFO] Step 5400/202000; acc:  72.80; ppl:  2.98; xent: 1.09; lr: 0.00120; 25666/25485 tok/s;   7077 sec
[2021-01-27 16:22:27,866 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 16:22:35,933 INFO] number of examples: 421684
[2021-01-27 16:23:25,767 INFO] Step 5500/202000; acc:  72.93; ppl:  2.95; xent: 1.08; lr: 0.00119; 25236/25197 tok/s;   7207 sec
[2021-01-27 16:23:25,768 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:23:25,810 INFO] number of examples: 5006
[2021-01-27 16:23:32,868 INFO] Validation perplexity: 3.59409
[2021-01-27 16:23:32,869 INFO] Validation accuracy: 72.994
[2021-01-27 16:23:32,869 INFO] Model is improving acc: 72.8218 --> 72.994.
[2021-01-27 16:23:32,869 INFO] Model is improving ppl: 3.61482 --> 3.59409.
[2021-01-27 16:23:33,095 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_5500.pt
[2021-01-27 16:25:43,563 INFO] Step 5600/202000; acc:  72.83; ppl:  2.96; xent: 1.09; lr: 0.00118; 23749/23584 tok/s;   7344 sec
[2021-01-27 16:27:52,079 INFO] Step 5700/202000; acc:  73.28; ppl:  2.90; xent: 1.07; lr: 0.00117; 25680/25405 tok/s;   7473 sec
[2021-01-27 16:29:24,108 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 16:29:47,008 INFO] number of examples: 892901
[2021-01-27 16:30:01,130 INFO] Step 5800/202000; acc:  73.20; ppl:  2.91; xent: 1.07; lr: 0.00116; 25507/25417 tok/s;   7602 sec
[2021-01-27 16:32:10,571 INFO] Step 5900/202000; acc:  73.12; ppl:  2.92; xent: 1.07; lr: 0.00115; 25202/25249 tok/s;   7731 sec
[2021-01-27 16:34:19,110 INFO] Step 6000/202000; acc:  73.30; ppl:  2.89; xent: 1.06; lr: 0.00114; 25612/25542 tok/s;   7860 sec
[2021-01-27 16:34:19,111 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:34:19,199 INFO] number of examples: 5006
[2021-01-27 16:34:26,256 INFO] Validation perplexity: 3.54359
[2021-01-27 16:34:26,256 INFO] Validation accuracy: 73.26
[2021-01-27 16:34:26,256 INFO] Model is improving acc: 72.994 --> 73.26.
[2021-01-27 16:34:26,256 INFO] Model is improving ppl: 3.59409 --> 3.54359.
[2021-01-27 16:34:26,482 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_6000.pt
[2021-01-27 16:36:36,681 INFO] Step 6100/202000; acc:  73.22; ppl:  2.89; xent: 1.06; lr: 0.00113; 23948/23976 tok/s;   7997 sec
[2021-01-27 16:38:45,748 INFO] Step 6200/202000; acc:  73.59; ppl:  2.84; xent: 1.04; lr: 0.00112; 25595/25438 tok/s;   8127 sec
[2021-01-27 16:40:54,067 INFO] Step 6300/202000; acc:  73.52; ppl:  2.85; xent: 1.05; lr: 0.00111; 25662/25368 tok/s;   8255 sec
[2021-01-27 16:43:03,253 INFO] Step 6400/202000; acc:  73.70; ppl:  2.83; xent: 1.04; lr: 0.00110; 25618/25542 tok/s;   8384 sec
[2021-01-27 16:43:54,070 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 16:44:01,792 INFO] number of examples: 421684
[2021-01-27 16:45:12,600 INFO] Step 6500/202000; acc:  73.69; ppl:  2.82; xent: 1.04; lr: 0.00110; 25210/25096 tok/s;   8513 sec
[2021-01-27 16:45:12,601 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:45:12,643 INFO] number of examples: 5006
[2021-01-27 16:45:19,732 INFO] Validation perplexity: 3.47186
[2021-01-27 16:45:19,732 INFO] Validation accuracy: 73.4812
[2021-01-27 16:45:19,732 INFO] Model is improving acc: 73.26 --> 73.4812.
[2021-01-27 16:45:19,732 INFO] Model is improving ppl: 3.54359 --> 3.47186.
[2021-01-27 16:45:19,959 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_6500.pt
[2021-01-27 16:47:29,896 INFO] Step 6600/202000; acc:  73.76; ppl:  2.81; xent: 1.03; lr: 0.00109; 23897/23768 tok/s;   8651 sec
[2021-01-27 16:49:38,876 INFO] Step 6700/202000; acc:  73.89; ppl:  2.79; xent: 1.03; lr: 0.00108; 25630/25345 tok/s;   8780 sec
[2021-01-27 16:50:49,744 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 16:51:11,124 INFO] number of examples: 892901
[2021-01-27 16:51:48,037 INFO] Step 6800/202000; acc:  73.98; ppl:  2.78; xent: 1.02; lr: 0.00107; 25464/25380 tok/s;   8909 sec
[2021-01-27 16:53:56,955 INFO] Step 6900/202000; acc:  73.82; ppl:  2.80; xent: 1.03; lr: 0.00106; 25255/25306 tok/s;   9038 sec
[2021-01-27 16:56:05,939 INFO] Step 7000/202000; acc:  73.98; ppl:  2.77; xent: 1.02; lr: 0.00106; 25498/25454 tok/s;   9167 sec
[2021-01-27 16:56:05,940 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 16:56:06,031 INFO] number of examples: 5006
[2021-01-27 16:56:13,088 INFO] Validation perplexity: 3.43787
[2021-01-27 16:56:13,088 INFO] Validation accuracy: 73.6461
[2021-01-27 16:56:13,088 INFO] Model is improving acc: 73.4812 --> 73.6461.
[2021-01-27 16:56:13,088 INFO] Model is improving ppl: 3.47186 --> 3.43787.
[2021-01-27 16:56:13,315 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_7000.pt
[2021-01-27 16:58:23,756 INFO] Step 7100/202000; acc:  73.96; ppl:  2.77; xent: 1.02; lr: 0.00105; 23946/23932 tok/s;   9305 sec
[2021-01-27 17:00:32,498 INFO] Step 7200/202000; acc:  74.33; ppl:  2.72; xent: 1.00; lr: 0.00104; 25673/25491 tok/s;   9433 sec
[2021-01-27 17:02:41,145 INFO] Step 7300/202000; acc:  74.14; ppl:  2.75; xent: 1.01; lr: 0.00103; 25621/25315 tok/s;   9562 sec
[2021-01-27 17:04:50,250 INFO] Step 7400/202000; acc:  74.36; ppl:  2.72; xent: 1.00; lr: 0.00103; 25532/25590 tok/s;   9691 sec
[2021-01-27 17:05:20,103 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 17:05:27,447 INFO] number of examples: 421684
[2021-01-27 17:06:59,454 INFO] Step 7500/202000; acc:  74.38; ppl:  2.71; xent: 1.00; lr: 0.00102; 25246/25056 tok/s;   9820 sec
[2021-01-27 17:06:59,455 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 17:06:59,497 INFO] number of examples: 5006
[2021-01-27 17:07:06,596 INFO] Validation perplexity: 3.40685
[2021-01-27 17:07:06,596 INFO] Validation accuracy: 73.6988
[2021-01-27 17:07:06,596 INFO] Model is improving acc: 73.6461 --> 73.6988.
[2021-01-27 17:07:06,597 INFO] Model is improving ppl: 3.43787 --> 3.40685.
[2021-01-27 17:07:06,824 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_7500.pt
[2021-01-27 17:09:17,177 INFO] Step 7600/202000; acc:  74.47; ppl:  2.70; xent: 0.99; lr: 0.00101; 23923/23780 tok/s;   9958 sec
[2021-01-27 17:11:26,211 INFO] Step 7700/202000; acc:  74.42; ppl:  2.71; xent: 1.00; lr: 0.00101; 25531/25282 tok/s;  10087 sec
[2021-01-27 17:12:16,552 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 17:12:36,285 INFO] number of examples: 892901
[2021-01-27 17:13:35,123 INFO] Step 7800/202000; acc:  74.66; ppl:  2.68; xent: 0.99; lr: 0.00100; 25429/25372 tok/s;  10216 sec
[2021-01-27 17:15:44,225 INFO] Step 7900/202000; acc:  74.43; ppl:  2.70; xent: 0.99; lr: 0.00099; 25350/25364 tok/s;  10345 sec
[2021-01-27 17:17:53,078 INFO] Step 8000/202000; acc:  74.61; ppl:  2.67; xent: 0.98; lr: 0.00099; 25532/25505 tok/s;  10474 sec
[2021-01-27 17:17:53,079 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 17:17:53,171 INFO] number of examples: 5006
[2021-01-27 17:18:00,225 INFO] Validation perplexity: 3.38816
[2021-01-27 17:18:00,225 INFO] Validation accuracy: 73.911
[2021-01-27 17:18:00,225 INFO] Model is improving acc: 73.6988 --> 73.911.
[2021-01-27 17:18:00,225 INFO] Model is improving ppl: 3.40685 --> 3.38816.
[2021-01-27 17:18:00,451 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_8000.pt
[2021-01-27 17:20:10,943 INFO] Step 8100/202000; acc:  74.52; ppl:  2.68; xent: 0.99; lr: 0.00098; 23973/23924 tok/s;  10612 sec
[2021-01-27 17:22:19,472 INFO] Step 8200/202000; acc:  74.94; ppl:  2.63; xent: 0.97; lr: 0.00098; 25601/25414 tok/s;  10740 sec
[2021-01-27 17:24:28,448 INFO] Step 8300/202000; acc:  74.68; ppl:  2.66; xent: 0.98; lr: 0.00097; 25622/25365 tok/s;  10869 sec
[2021-01-27 17:26:38,008 INFO] Step 8400/202000; acc:  74.93; ppl:  2.63; xent: 0.97; lr: 0.00096; 25391/25390 tok/s;  10999 sec
[2021-01-27 17:26:47,202 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 17:26:53,971 INFO] number of examples: 421684
[2021-01-27 17:28:46,705 INFO] Step 8500/202000; acc:  74.88; ppl:  2.63; xent: 0.97; lr: 0.00096; 25341/25150 tok/s;  11127 sec
[2021-01-27 17:28:46,706 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 17:28:46,748 INFO] number of examples: 5006
[2021-01-27 17:28:53,813 INFO] Validation perplexity: 3.39286
[2021-01-27 17:28:53,814 INFO] Validation accuracy: 73.9602
[2021-01-27 17:28:53,814 INFO] Stalled patience: 4/5
[2021-01-27 17:28:54,040 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_8500.pt
[2021-01-27 17:31:04,705 INFO] Step 8600/202000; acc:  75.07; ppl:  2.61; xent: 0.96; lr: 0.00095; 23896/23806 tok/s;  11265 sec
[2021-01-27 17:33:13,823 INFO] Step 8700/202000; acc:  74.93; ppl:  2.63; xent: 0.97; lr: 0.00095; 25545/25304 tok/s;  11395 sec
[2021-01-27 17:33:43,691 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 17:34:05,454 INFO] number of examples: 892901
[2021-01-27 17:35:22,836 INFO] Step 8800/202000; acc:  75.10; ppl:  2.61; xent: 0.96; lr: 0.00094; 25268/25298 tok/s;  11524 sec
[2021-01-27 17:37:31,974 INFO] Step 8900/202000; acc:  75.04; ppl:  2.61; xent: 0.96; lr: 0.00094; 25500/25448 tok/s;  11653 sec
[2021-01-27 17:39:40,731 INFO] Step 9000/202000; acc:  74.88; ppl:  2.63; xent: 0.97; lr: 0.00093; 25497/25479 tok/s;  11781 sec
[2021-01-27 17:39:40,732 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 17:39:40,777 INFO] number of examples: 5006
[2021-01-27 17:39:47,868 INFO] Validation perplexity: 3.34856
[2021-01-27 17:39:47,868 INFO] Validation accuracy: 74.1055
[2021-01-27 17:39:47,868 INFO] Model is improving acc: 73.911 --> 74.1055.
[2021-01-27 17:39:47,868 INFO] Model is improving ppl: 3.38816 --> 3.34856.
[2021-01-27 17:39:48,095 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_9000.pt
[2021-01-27 17:41:58,456 INFO] Step 9100/202000; acc:  75.16; ppl:  2.59; xent: 0.95; lr: 0.00093; 23989/23866 tok/s;  11919 sec
[2021-01-27 17:44:07,295 INFO] Step 9200/202000; acc:  75.35; ppl:  2.58; xent: 0.95; lr: 0.00092; 25535/25394 tok/s;  12048 sec
[2021-01-27 17:46:16,317 INFO] Step 9300/202000; acc:  75.22; ppl:  2.59; xent: 0.95; lr: 0.00092; 25643/25375 tok/s;  12177 sec
[2021-01-27 17:48:14,265 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 17:48:21,331 INFO] number of examples: 421684
[2021-01-27 17:48:25,780 INFO] Step 9400/202000; acc:  75.41; ppl:  2.56; xent: 0.94; lr: 0.00091; 25399/25397 tok/s;  12307 sec
[2021-01-27 17:50:34,609 INFO] Step 9500/202000; acc:  75.35; ppl:  2.57; xent: 0.94; lr: 0.00091; 25314/25148 tok/s;  12435 sec
[2021-01-27 17:50:34,610 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 17:50:34,697 INFO] number of examples: 5006
[2021-01-27 17:50:41,758 INFO] Validation perplexity: 3.32545
[2021-01-27 17:50:41,759 INFO] Validation accuracy: 74.2012
[2021-01-27 17:50:41,759 INFO] Model is improving acc: 74.1055 --> 74.2012.
[2021-01-27 17:50:41,759 INFO] Model is improving ppl: 3.34856 --> 3.32545.
[2021-01-27 17:50:41,986 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_9500.pt
[2021-01-27 17:52:52,796 INFO] Step 9600/202000; acc:  75.50; ppl:  2.55; xent: 0.94; lr: 0.00090; 23956/23720 tok/s;  12574 sec
[2021-01-27 17:55:01,567 INFO] Step 9700/202000; acc:  75.34; ppl:  2.57; xent: 0.94; lr: 0.00090; 25506/25392 tok/s;  12702 sec
[2021-01-27 17:55:10,922 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 17:55:30,527 INFO] number of examples: 892901
[2021-01-27 17:57:10,509 INFO] Step 9800/202000; acc:  75.61; ppl:  2.54; xent: 0.93; lr: 0.00089; 25334/25336 tok/s;  12831 sec
[2021-01-27 17:59:19,767 INFO] Step 9900/202000; acc:  75.43; ppl:  2.55; xent: 0.94; lr: 0.00089; 25452/25443 tok/s;  12961 sec
[2021-01-27 18:01:28,472 INFO] Step 10000/202000; acc:  75.41; ppl:  2.56; xent: 0.94; lr: 0.00088; 25526/25490 tok/s;  13089 sec
[2021-01-27 18:01:28,473 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:01:28,516 INFO] number of examples: 5006
[2021-01-27 18:01:35,619 INFO] Validation perplexity: 3.3496
[2021-01-27 18:01:35,619 INFO] Validation accuracy: 74.224
[2021-01-27 18:01:35,619 INFO] Stalled patience: 4/5
[2021-01-27 18:01:35,846 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_10000.pt
[2021-01-27 18:03:45,703 INFO] Step 10100/202000; acc:  75.65; ppl:  2.53; xent: 0.93; lr: 0.00088; 24073/23920 tok/s;  13226 sec
[2021-01-27 18:05:54,390 INFO] Step 10200/202000; acc:  75.75; ppl:  2.52; xent: 0.92; lr: 0.00088; 25537/25384 tok/s;  13355 sec
[2021-01-27 18:08:03,327 INFO] Step 10300/202000; acc:  75.68; ppl:  2.52; xent: 0.93; lr: 0.00087; 25725/25497 tok/s;  13484 sec
[2021-01-27 18:09:40,777 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 18:09:47,619 INFO] number of examples: 421684
[2021-01-27 18:10:12,694 INFO] Step 10400/202000; acc:  75.86; ppl:  2.50; xent: 0.92; lr: 0.00087; 25290/25251 tok/s;  13613 sec
[2021-01-27 18:12:21,552 INFO] Step 10500/202000; acc:  75.66; ppl:  2.52; xent: 0.93; lr: 0.00086; 25348/25171 tok/s;  13742 sec
[2021-01-27 18:12:21,554 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:12:21,645 INFO] number of examples: 5006
[2021-01-27 18:12:28,703 INFO] Validation perplexity: 3.30877
[2021-01-27 18:12:28,703 INFO] Validation accuracy: 74.3628
[2021-01-27 18:12:28,703 INFO] Model is improving acc: 74.2012 --> 74.3628.
[2021-01-27 18:12:28,703 INFO] Model is improving ppl: 3.32545 --> 3.30877.
[2021-01-27 18:12:28,931 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_10500.pt
[2021-01-27 18:14:39,616 INFO] Step 10600/202000; acc:  76.04; ppl:  2.48; xent: 0.91; lr: 0.00086; 23967/23720 tok/s;  13880 sec
[2021-01-27 18:16:37,600 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 18:16:49,071 INFO] Step 10700/202000; acc:  75.81; ppl:  2.51; xent: 0.92; lr: 0.00085; 25429/25396 tok/s;  14010 sec
[2021-01-27 18:16:55,711 INFO] number of examples: 892901
[2021-01-27 18:18:58,208 INFO] Step 10800/202000; acc:  75.86; ppl:  2.50; xent: 0.92; lr: 0.00085; 25225/25277 tok/s;  14139 sec
[2021-01-27 18:21:06,763 INFO] Step 10900/202000; acc:  75.86; ppl:  2.49; xent: 0.91; lr: 0.00085; 25630/25533 tok/s;  14268 sec
[2021-01-27 18:23:15,720 INFO] Step 11000/202000; acc:  75.70; ppl:  2.51; xent: 0.92; lr: 0.00084; 25493/25495 tok/s;  14396 sec
[2021-01-27 18:23:15,721 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:23:15,763 INFO] number of examples: 5006
[2021-01-27 18:23:22,841 INFO] Validation perplexity: 3.31354
[2021-01-27 18:23:22,841 INFO] Validation accuracy: 74.3946
[2021-01-27 18:23:22,841 INFO] Stalled patience: 4/5
[2021-01-27 18:23:23,071 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_11000.pt
[2021-01-27 18:25:32,897 INFO] Step 11100/202000; acc:  76.11; ppl:  2.47; xent: 0.90; lr: 0.00084; 24055/23939 tok/s;  14534 sec
[2021-01-27 18:27:41,451 INFO] Step 11200/202000; acc:  76.21; ppl:  2.46; xent: 0.90; lr: 0.00084; 25646/25402 tok/s;  14662 sec
[2021-01-27 18:29:50,402 INFO] Step 11300/202000; acc:  76.07; ppl:  2.47; xent: 0.91; lr: 0.00083; 25685/25521 tok/s;  14791 sec
[2021-01-27 18:31:08,201 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 18:31:16,342 INFO] number of examples: 421684
[2021-01-27 18:31:59,624 INFO] Step 11400/202000; acc:  76.18; ppl:  2.46; xent: 0.90; lr: 0.00083; 25305/25225 tok/s;  14920 sec
[2021-01-27 18:34:08,731 INFO] Step 11500/202000; acc:  76.07; ppl:  2.47; xent: 0.90; lr: 0.00082; 25300/25182 tok/s;  15049 sec
[2021-01-27 18:34:08,732 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:34:08,828 INFO] number of examples: 5006
[2021-01-27 18:34:15,900 INFO] Validation perplexity: 3.299
[2021-01-27 18:34:15,900 INFO] Validation accuracy: 74.4047
[2021-01-27 18:34:15,900 INFO] Model is improving acc: 74.3628 --> 74.4047.
[2021-01-27 18:34:15,900 INFO] Model is improving ppl: 3.30877 --> 3.299.
[2021-01-27 18:34:16,127 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_11500.pt
[2021-01-27 18:36:26,208 INFO] Step 11600/202000; acc:  76.40; ppl:  2.44; xent: 0.89; lr: 0.00082; 24037/23732 tok/s;  15187 sec
[2021-01-27 18:38:03,421 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 18:38:24,102 INFO] number of examples: 892901
[2021-01-27 18:38:35,432 INFO] Step 11700/202000; acc:  76.26; ppl:  2.45; xent: 0.90; lr: 0.00082; 25461/25402 tok/s;  15316 sec
[2021-01-27 18:40:44,429 INFO] Step 11800/202000; acc:  76.12; ppl:  2.46; xent: 0.90; lr: 0.00081; 25270/25321 tok/s;  15445 sec
[2021-01-27 18:42:53,404 INFO] Step 11900/202000; acc:  76.22; ppl:  2.45; xent: 0.90; lr: 0.00081; 25518/25509 tok/s;  15574 sec
[2021-01-27 18:45:02,552 INFO] Step 12000/202000; acc:  76.14; ppl:  2.46; xent: 0.90; lr: 0.00081; 25519/25514 tok/s;  15703 sec
[2021-01-27 18:45:02,553 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:45:02,596 INFO] number of examples: 5006
[2021-01-27 18:45:09,678 INFO] Validation perplexity: 3.28924
[2021-01-27 18:45:09,678 INFO] Validation accuracy: 74.443
[2021-01-27 18:45:09,678 INFO] Model is improving acc: 74.4047 --> 74.443.
[2021-01-27 18:45:09,678 INFO] Model is improving ppl: 3.299 --> 3.28924.
[2021-01-27 18:45:09,905 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_12000.pt
[2021-01-27 18:47:19,837 INFO] Step 12100/202000; acc:  76.56; ppl:  2.42; xent: 0.88; lr: 0.00080; 24108/23913 tok/s;  15841 sec
[2021-01-27 18:49:28,463 INFO] Step 12200/202000; acc:  76.44; ppl:  2.42; xent: 0.89; lr: 0.00080; 25581/25353 tok/s;  15969 sec
[2021-01-27 18:51:37,717 INFO] Step 12300/202000; acc:  76.46; ppl:  2.42; xent: 0.89; lr: 0.00080; 25611/25467 tok/s;  16098 sec
[2021-01-27 18:52:34,688 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 18:52:45,464 INFO] number of examples: 421684
[2021-01-27 18:53:46,834 INFO] Step 12400/202000; acc:  76.50; ppl:  2.42; xent: 0.88; lr: 0.00079; 25206/25183 tok/s;  16228 sec
[2021-01-27 18:55:55,528 INFO] Step 12500/202000; acc:  76.48; ppl:  2.42; xent: 0.88; lr: 0.00079; 25497/25322 tok/s;  16356 sec
[2021-01-27 18:55:55,529 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 18:55:55,573 INFO] number of examples: 5006
[2021-01-27 18:56:02,672 INFO] Validation perplexity: 3.31023
[2021-01-27 18:56:02,672 INFO] Validation accuracy: 74.4356
[2021-01-27 18:56:02,672 INFO] Decreasing patience: 4/5
[2021-01-27 18:56:02,899 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_12500.pt
[2021-01-27 18:58:13,582 INFO] Step 12600/202000; acc:  76.64; ppl:  2.41; xent: 0.88; lr: 0.00079; 23950/23680 tok/s;  16494 sec
[2021-01-27 18:59:31,199 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 18:59:49,118 INFO] number of examples: 892901
[2021-01-27 19:00:22,812 INFO] Step 12700/202000; acc:  76.62; ppl:  2.41; xent: 0.88; lr: 0.00078; 25490/25357 tok/s;  16624 sec
[2021-01-27 19:02:31,842 INFO] Step 12800/202000; acc:  76.40; ppl:  2.43; xent: 0.89; lr: 0.00078; 25214/25314 tok/s;  16753 sec
[2021-01-27 19:04:40,578 INFO] Step 12900/202000; acc:  76.55; ppl:  2.41; xent: 0.88; lr: 0.00078; 25571/25485 tok/s;  16881 sec
[2021-01-27 19:06:49,653 INFO] Step 13000/202000; acc:  76.51; ppl:  2.41; xent: 0.88; lr: 0.00078; 25544/25554 tok/s;  17010 sec
[2021-01-27 19:06:49,653 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 19:06:49,740 INFO] number of examples: 5006
[2021-01-27 19:06:56,797 INFO] Validation perplexity: 3.29849
[2021-01-27 19:06:56,797 INFO] Validation accuracy: 74.4775
[2021-01-27 19:06:56,797 INFO] Stalled patience: 4/5
[2021-01-27 19:06:57,023 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_13000.pt
[2021-01-27 19:09:07,557 INFO] Step 13100/202000; acc:  76.81; ppl:  2.38; xent: 0.87; lr: 0.00077; 23959/23807 tok/s;  17148 sec
[2021-01-27 19:11:16,136 INFO] Step 13200/202000; acc:  76.70; ppl:  2.39; xent: 0.87; lr: 0.00077; 25620/25318 tok/s;  17277 sec
[2021-01-27 19:13:25,535 INFO] Step 13300/202000; acc:  76.84; ppl:  2.38; xent: 0.87; lr: 0.00077; 25505/25522 tok/s;  17406 sec
[2021-01-27 19:14:01,668 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 19:14:08,588 INFO] number of examples: 421684
[2021-01-27 19:15:34,307 INFO] Step 13400/202000; acc:  76.88; ppl:  2.38; xent: 0.87; lr: 0.00076; 25378/25210 tok/s;  17535 sec
[2021-01-27 19:17:43,165 INFO] Step 13500/202000; acc:  76.81; ppl:  2.38; xent: 0.87; lr: 0.00076; 25499/25329 tok/s;  17664 sec
[2021-01-27 19:17:43,166 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 19:17:43,208 INFO] number of examples: 5006
[2021-01-27 19:17:50,289 INFO] Validation perplexity: 3.27736
[2021-01-27 19:17:50,289 INFO] Validation accuracy: 74.4756
[2021-01-27 19:17:50,290 INFO] Model is improving acc: 74.443 --> 74.4756.
[2021-01-27 19:17:50,290 INFO] Model is improving ppl: 3.28924 --> 3.27736.
[2021-01-27 19:17:50,516 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_13500.pt
[2021-01-27 19:20:00,820 INFO] Step 13600/202000; acc:  76.84; ppl:  2.38; xent: 0.87; lr: 0.00076; 23956/23706 tok/s;  17802 sec
[2021-01-27 19:20:57,585 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 19:21:15,637 INFO] number of examples: 892901
[2021-01-27 19:22:09,945 INFO] Step 13700/202000; acc:  77.00; ppl:  2.36; xent: 0.86; lr: 0.00076; 25427/25364 tok/s;  17931 sec
[2021-01-27 19:24:18,983 INFO] Step 13800/202000; acc:  76.73; ppl:  2.39; xent: 0.87; lr: 0.00075; 25323/25352 tok/s;  18060 sec
[2021-01-27 19:26:28,143 INFO] Step 13900/202000; acc:  76.85; ppl:  2.37; xent: 0.86; lr: 0.00075; 25465/25456 tok/s;  18189 sec
[2021-01-27 19:28:37,279 INFO] Step 14000/202000; acc:  76.84; ppl:  2.37; xent: 0.86; lr: 0.00075; 25585/25520 tok/s;  18318 sec
[2021-01-27 19:28:37,280 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 19:28:37,372 INFO] number of examples: 5006
[2021-01-27 19:28:44,445 INFO] Validation perplexity: 3.28768
[2021-01-27 19:28:44,446 INFO] Validation accuracy: 74.4639
[2021-01-27 19:28:44,446 INFO] Decreasing patience: 4/5
[2021-01-27 19:28:44,672 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_14000.pt
[2021-01-27 19:30:54,557 INFO] Step 14100/202000; acc:  77.12; ppl:  2.35; xent: 0.85; lr: 0.00074; 23985/23793 tok/s;  18455 sec
[2021-01-27 19:33:03,907 INFO] Step 14200/202000; acc:  77.00; ppl:  2.36; xent: 0.86; lr: 0.00074; 25531/25308 tok/s;  18585 sec
[2021-01-27 19:35:13,109 INFO] Step 14300/202000; acc:  77.11; ppl:  2.35; xent: 0.85; lr: 0.00074; 25485/25454 tok/s;  18714 sec
[2021-01-27 19:35:28,695 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 19:35:36,923 INFO] number of examples: 421684
[2021-01-27 19:37:21,648 INFO] Step 14400/202000; acc:  77.10; ppl:  2.35; xent: 0.85; lr: 0.00074; 25354/25194 tok/s;  18842 sec
[2021-01-27 19:39:30,898 INFO] Step 14500/202000; acc:  77.24; ppl:  2.33; xent: 0.85; lr: 0.00073; 25531/25451 tok/s;  18972 sec
[2021-01-27 19:39:30,899 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 19:39:30,942 INFO] number of examples: 5006
[2021-01-27 19:39:38,006 INFO] Validation perplexity: 3.291
[2021-01-27 19:39:38,007 INFO] Validation accuracy: 74.5766
[2021-01-27 19:39:38,007 INFO] Stalled patience: 4/5
[2021-01-27 19:39:38,234 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_14500.pt
[2021-01-27 19:41:48,426 INFO] Step 14600/202000; acc:  77.03; ppl:  2.35; xent: 0.86; lr: 0.00073; 23978/23715 tok/s;  19109 sec
[2021-01-27 19:42:24,718 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 19:42:45,632 INFO] number of examples: 892901
[2021-01-27 19:43:57,617 INFO] Step 14700/202000; acc:  77.24; ppl:  2.34; xent: 0.85; lr: 0.00073; 25248/25267 tok/s;  19238 sec
[2021-01-27 19:46:06,623 INFO] Step 14800/202000; acc:  77.08; ppl:  2.35; xent: 0.85; lr: 0.00073; 25486/25445 tok/s;  19367 sec
[2021-01-27 19:48:15,925 INFO] Step 14900/202000; acc:  77.00; ppl:  2.35; xent: 0.86; lr: 0.00072; 25390/25392 tok/s;  19497 sec
[2021-01-27 19:50:24,720 INFO] Step 15000/202000; acc:  77.19; ppl:  2.33; xent: 0.85; lr: 0.00072; 25702/25540 tok/s;  19625 sec
[2021-01-27 19:50:24,721 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 19:50:24,819 INFO] number of examples: 5006
[2021-01-27 19:50:31,881 INFO] Validation perplexity: 3.30254
[2021-01-27 19:50:31,882 INFO] Validation accuracy: 74.4949
[2021-01-27 19:50:31,882 INFO] Stalled patience: 3/5
[2021-01-27 19:50:32,109 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_15000.pt
[2021-01-27 19:52:41,826 INFO] Step 15100/202000; acc:  77.42; ppl:  2.31; xent: 0.84; lr: 0.00072; 23959/23846 tok/s;  19763 sec
[2021-01-27 19:54:50,959 INFO] Step 15200/202000; acc:  77.24; ppl:  2.33; xent: 0.85; lr: 0.00072; 25617/25371 tok/s;  19892 sec
[2021-01-27 19:56:55,137 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 19:57:00,213 INFO] Step 15300/202000; acc:  77.40; ppl:  2.31; xent: 0.84; lr: 0.00071; 25439/25445 tok/s;  20021 sec
[2021-01-27 19:57:06,016 INFO] number of examples: 421684
[2021-01-27 19:59:08,990 INFO] Step 15400/202000; acc:  77.36; ppl:  2.32; xent: 0.84; lr: 0.00071; 25353/25161 tok/s;  20150 sec
[2021-01-27 20:01:17,886 INFO] Step 15500/202000; acc:  77.49; ppl:  2.31; xent: 0.84; lr: 0.00071; 25632/25444 tok/s;  20279 sec
[2021-01-27 20:01:17,887 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 20:01:17,929 INFO] number of examples: 5006
[2021-01-27 20:01:24,998 INFO] Validation perplexity: 3.29898
[2021-01-27 20:01:24,998 INFO] Validation accuracy: 74.4913
[2021-01-27 20:01:24,998 INFO] Stalled patience: 2/5
[2021-01-27 20:01:25,226 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_15500.pt
[2021-01-27 20:03:34,954 INFO] Step 15600/202000; acc:  77.31; ppl:  2.32; xent: 0.84; lr: 0.00071; 23999/23839 tok/s;  20416 sec
[2021-01-27 20:03:50,669 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-01-27 20:04:08,807 INFO] number of examples: 892901
[2021-01-27 20:05:44,160 INFO] Step 15700/202000; acc:  77.49; ppl:  2.31; xent: 0.84; lr: 0.00071; 25261/25278 tok/s;  20545 sec
[2021-01-27 20:07:53,463 INFO] Step 15800/202000; acc:  77.34; ppl:  2.31; xent: 0.84; lr: 0.00070; 25462/25400 tok/s;  20674 sec
[2021-01-27 20:10:02,127 INFO] Step 15900/202000; acc:  77.26; ppl:  2.33; xent: 0.84; lr: 0.00070; 25503/25512 tok/s;  20803 sec
[2021-01-27 20:12:11,145 INFO] Step 16000/202000; acc:  77.54; ppl:  2.30; xent: 0.83; lr: 0.00070; 25630/25466 tok/s;  20932 sec
[2021-01-27 20:12:11,146 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 20:12:11,190 INFO] number of examples: 5006
[2021-01-27 20:12:18,258 INFO] Validation perplexity: 3.29192
[2021-01-27 20:12:18,258 INFO] Validation accuracy: 74.6147
[2021-01-27 20:12:18,258 INFO] Stalled patience: 1/5
[2021-01-27 20:12:18,490 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_16000.pt
[2021-01-27 20:14:28,341 INFO] Step 16100/202000; acc:  77.54; ppl:  2.30; xent: 0.83; lr: 0.00070; 23950/23826 tok/s;  21069 sec
[2021-01-27 20:16:37,471 INFO] Step 16200/202000; acc:  77.55; ppl:  2.29; xent: 0.83; lr: 0.00069; 25677/25445 tok/s;  21198 sec
[2021-01-27 20:18:20,992 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-01-27 20:18:28,082 INFO] number of examples: 421684
[2021-01-27 20:18:46,770 INFO] Step 16300/202000; acc:  77.63; ppl:  2.29; xent: 0.83; lr: 0.00069; 25359/25311 tok/s;  21328 sec
[2021-01-27 20:20:55,832 INFO] Step 16400/202000; acc:  77.58; ppl:  2.30; xent: 0.83; lr: 0.00069; 25241/25029 tok/s;  21457 sec
[2021-01-27 20:23:04,997 INFO] Step 16500/202000; acc:  77.79; ppl:  2.27; xent: 0.82; lr: 0.00069; 25644/25421 tok/s;  21586 sec
[2021-01-27 20:23:04,998 INFO] Loading dataset from /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-01-27 20:23:05,088 INFO] number of examples: 5006
[2021-01-27 20:23:12,145 INFO] Validation perplexity: 3.29067
[2021-01-27 20:23:12,145 INFO] Validation accuracy: 74.6082
[2021-01-27 20:23:12,145 INFO] Stalled patience: 0/5
[2021-01-27 20:23:12,145 INFO] Training finished after stalled validations. Early Stop!
[2021-01-27 20:23:12,145 INFO] Best model found at step 13500
[2021-01-27 20:23:12,383 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/ES-EN-TRANS-BPE/model/model_step_16500.pt

[2021-02-19 19:13:03,920 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 19:13:04,947 INFO]  * src vocab size = 46940
[2021-02-19 19:13:04,947 INFO]  * tgt vocab size = 47978
[2021-02-19 19:13:04,947 INFO] Building model...
[2021-02-19 19:13:10,321 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(46940, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(47978, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=512, out_features=47978, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2021-02-19 19:13:10,325 INFO] encoder: 42948608
[2021-02-19 19:13:10,325 INFO] decoder: 74402666
[2021-02-19 19:13:10,325 INFO] * number of parameters: 117351274
[2021-02-19 19:13:10,337 INFO] Starting training on GPU: [0, 1, 2]
[2021-02-19 19:13:10,337 INFO] Start training loop and validate every 500 steps...
[2021-02-19 19:13:17,263 INFO] number of examples: 878269
[2021-02-19 19:15:48,138 INFO] Step 100/202000; acc:   4.12; ppl: 3791.22; xent: 8.24; lr: 0.00010; 19461/22285 tok/s;    158 sec
[2021-02-19 19:18:00,578 INFO] Step 200/202000; acc:   7.27; ppl: 360.27; xent: 5.89; lr: 0.00020; 23056/26609 tok/s;    290 sec
[2021-02-19 19:20:12,542 INFO] Step 300/202000; acc:  14.00; ppl: 167.28; xent: 5.12; lr: 0.00030; 23280/26691 tok/s;    422 sec
[2021-02-19 19:22:25,415 INFO] Step 400/202000; acc:  19.12; ppl: 87.94; xent: 4.48; lr: 0.00040; 23177/26499 tok/s;    555 sec
[2021-02-19 19:24:37,815 INFO] Step 500/202000; acc:  22.57; ppl: 60.47; xent: 4.10; lr: 0.00050; 23144/26609 tok/s;    687 sec
[2021-02-19 19:24:37,816 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 19:24:37,868 INFO] number of examples: 6594
[2021-02-19 19:24:47,350 INFO] Validation perplexity: 87.0174
[2021-02-19 19:24:47,350 INFO] Validation accuracy: 24.5588
[2021-02-19 19:24:47,350 INFO] Model is improving ppl: inf --> 87.0174.
[2021-02-19 19:24:47,350 INFO] Model is improving acc: -inf --> 24.5588.
[2021-02-19 19:24:47,574 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_500.pt
[2021-02-19 19:25:31,635 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 19:25:41,885 INFO] number of examples: 410180
[2021-02-19 19:27:01,855 INFO] Step 600/202000; acc:  25.82; ppl: 44.90; xent: 3.80; lr: 0.00059; 21150/24236 tok/s;    832 sec
[2021-02-19 19:29:13,939 INFO] Step 700/202000; acc:  31.53; ppl: 31.61; xent: 3.45; lr: 0.00069; 22942/26444 tok/s;    964 sec
[2021-02-19 19:31:26,383 INFO] Step 800/202000; acc:  39.09; ppl: 21.17; xent: 3.05; lr: 0.00079; 23047/26340 tok/s;   1096 sec
[2021-02-19 19:32:21,960 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 19:32:44,687 INFO] number of examples: 878269
[2021-02-19 19:33:38,471 INFO] Step 900/202000; acc:  45.14; ppl: 15.06; xent: 2.71; lr: 0.00089; 23226/26715 tok/s;   1228 sec
[2021-02-19 19:35:50,767 INFO] Step 1000/202000; acc:  49.80; ppl: 11.50; xent: 2.44; lr: 0.00099; 23061/26491 tok/s;   1360 sec
[2021-02-19 19:35:50,768 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 19:35:50,877 INFO] number of examples: 6594
[2021-02-19 19:36:00,369 INFO] Validation perplexity: 12.4513
[2021-02-19 19:36:00,369 INFO] Validation accuracy: 53.5416
[2021-02-19 19:36:00,369 INFO] Model is improving ppl: 87.0174 --> 12.4513.
[2021-02-19 19:36:00,369 INFO] Model is improving acc: 24.5588 --> 53.5416.
[2021-02-19 19:36:00,592 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_1000.pt
[2021-02-19 19:38:14,391 INFO] Step 1100/202000; acc:  52.91; ppl:  9.60; xent: 2.26; lr: 0.00109; 21339/24381 tok/s;   1504 sec
[2021-02-19 19:40:26,737 INFO] Step 1200/202000; acc:  55.61; ppl:  8.19; xent: 2.10; lr: 0.00119; 23178/26751 tok/s;   1636 sec
[2021-02-19 19:42:39,536 INFO] Step 1300/202000; acc:  57.84; ppl:  7.22; xent: 1.98; lr: 0.00129; 23123/26576 tok/s;   1769 sec
[2021-02-19 19:44:51,867 INFO] Step 1400/202000; acc:  59.32; ppl:  6.61; xent: 1.89; lr: 0.00138; 23191/26631 tok/s;   1902 sec
[2021-02-19 19:47:04,436 INFO] Step 1500/202000; acc:  60.27; ppl:  6.23; xent: 1.83; lr: 0.00148; 23109/26460 tok/s;   2034 sec
[2021-02-19 19:47:04,437 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 19:47:04,487 INFO] number of examples: 6594
[2021-02-19 19:47:13,980 INFO] Validation perplexity: 6.68888
[2021-02-19 19:47:13,980 INFO] Validation accuracy: 62.8309
[2021-02-19 19:47:13,980 INFO] Model is improving ppl: 12.4513 --> 6.68888.
[2021-02-19 19:47:13,980 INFO] Model is improving acc: 53.5416 --> 62.8309.
[2021-02-19 19:47:14,203 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_1500.pt
[2021-02-19 19:47:26,737 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 19:47:39,686 INFO] number of examples: 410180
[2021-02-19 19:49:28,510 INFO] Step 1600/202000; acc:  61.41; ppl:  5.82; xent: 1.76; lr: 0.00158; 21076/24182 tok/s;   2178 sec
[2021-02-19 19:51:41,088 INFO] Step 1700/202000; acc:  62.43; ppl:  5.48; xent: 1.70; lr: 0.00168; 22843/26369 tok/s;   2311 sec
[2021-02-19 19:53:53,332 INFO] Step 1800/202000; acc:  63.06; ppl:  5.26; xent: 1.66; lr: 0.00178; 23171/26451 tok/s;   2443 sec
[2021-02-19 19:54:18,634 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 19:54:40,447 INFO] number of examples: 878269
[2021-02-19 19:56:06,114 INFO] Step 1900/202000; acc:  63.96; ppl:  4.99; xent: 1.61; lr: 0.00188; 23085/26522 tok/s;   2576 sec
[2021-02-19 19:58:18,412 INFO] Step 2000/202000; acc:  64.32; ppl:  4.86; xent: 1.58; lr: 0.00198; 23012/26477 tok/s;   2708 sec
[2021-02-19 19:58:18,413 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 19:58:18,506 INFO] number of examples: 6594
[2021-02-19 19:58:28,014 INFO] Validation perplexity: 5.26149
[2021-02-19 19:58:28,014 INFO] Validation accuracy: 66.0786
[2021-02-19 19:58:28,014 INFO] Model is improving ppl: 6.68888 --> 5.26149.
[2021-02-19 19:58:28,014 INFO] Model is improving acc: 62.8309 --> 66.0786.
[2021-02-19 19:58:28,240 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_2000.pt
[2021-02-19 20:00:41,763 INFO] Step 2100/202000; acc:  64.87; ppl:  4.68; xent: 1.54; lr: 0.00193; 21398/24547 tok/s;   2851 sec
[2021-02-19 20:02:54,162 INFO] Step 2200/202000; acc:  65.65; ppl:  4.47; xent: 1.50; lr: 0.00188; 23201/26690 tok/s;   2984 sec
[2021-02-19 20:05:06,473 INFO] Step 2300/202000; acc:  66.33; ppl:  4.30; xent: 1.46; lr: 0.00184; 23204/26627 tok/s;   3116 sec
[2021-02-19 20:07:19,089 INFO] Step 2400/202000; acc:  66.97; ppl:  4.14; xent: 1.42; lr: 0.00180; 23224/26570 tok/s;   3249 sec
[2021-02-19 20:09:11,134 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 20:09:20,080 INFO] number of examples: 410180
[2021-02-19 20:09:31,934 INFO] Step 2500/202000; acc:  67.33; ppl:  4.05; xent: 1.40; lr: 0.00177; 22989/26356 tok/s;   3382 sec
[2021-02-19 20:09:31,935 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 20:09:31,986 INFO] number of examples: 6594
[2021-02-19 20:09:41,495 INFO] Validation perplexity: 4.47939
[2021-02-19 20:09:41,495 INFO] Validation accuracy: 68.7538
[2021-02-19 20:09:41,495 INFO] Model is improving ppl: 5.26149 --> 4.47939.
[2021-02-19 20:09:41,495 INFO] Model is improving acc: 66.0786 --> 68.7538.
[2021-02-19 20:09:41,721 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_2500.pt
[2021-02-19 20:11:55,709 INFO] Step 2600/202000; acc:  67.59; ppl:  3.98; xent: 1.38; lr: 0.00173; 21050/24274 tok/s;   3525 sec
[2021-02-19 20:14:07,853 INFO] Step 2700/202000; acc:  68.13; ppl:  3.86; xent: 1.35; lr: 0.00170; 23045/26473 tok/s;   3658 sec
[2021-02-19 20:16:13,596 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 20:16:20,025 INFO] Step 2800/202000; acc:  68.54; ppl:  3.76; xent: 1.33; lr: 0.00167; 23196/26533 tok/s;   3790 sec
[2021-02-19 20:16:35,906 INFO] number of examples: 878269
[2021-02-19 20:18:32,280 INFO] Step 2900/202000; acc:  68.70; ppl:  3.71; xent: 1.31; lr: 0.00164; 23078/26515 tok/s;   3922 sec
[2021-02-19 20:20:44,430 INFO] Step 3000/202000; acc:  68.99; ppl:  3.65; xent: 1.29; lr: 0.00161; 23181/26562 tok/s;   4054 sec
[2021-02-19 20:20:44,431 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 20:20:44,523 INFO] number of examples: 6594
[2021-02-19 20:20:54,033 INFO] Validation perplexity: 4.11482
[2021-02-19 20:20:54,033 INFO] Validation accuracy: 70.0649
[2021-02-19 20:20:54,033 INFO] Model is improving ppl: 4.47939 --> 4.11482.
[2021-02-19 20:20:54,034 INFO] Model is improving acc: 68.7538 --> 70.0649.
[2021-02-19 20:20:54,256 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_3000.pt
[2021-02-19 20:23:07,908 INFO] Step 3100/202000; acc:  69.35; ppl:  3.57; xent: 1.27; lr: 0.00159; 21350/24556 tok/s;   4198 sec
[2021-02-19 20:25:20,332 INFO] Step 3200/202000; acc:  69.46; ppl:  3.54; xent: 1.26; lr: 0.00156; 23186/26652 tok/s;   4330 sec
[2021-02-19 20:27:32,834 INFO] Step 3300/202000; acc:  69.90; ppl:  3.46; xent: 1.24; lr: 0.00154; 23215/26598 tok/s;   4462 sec
[2021-02-19 20:29:45,419 INFO] Step 3400/202000; acc:  70.18; ppl:  3.40; xent: 1.22; lr: 0.00152; 23120/26661 tok/s;   4595 sec
[2021-02-19 20:31:06,933 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 20:31:15,395 INFO] number of examples: 410180
[2021-02-19 20:31:58,310 INFO] Step 3500/202000; acc:  70.14; ppl:  3.40; xent: 1.22; lr: 0.00149; 22927/26199 tok/s;   4728 sec
[2021-02-19 20:31:58,311 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 20:31:58,415 INFO] number of examples: 6594
[2021-02-19 20:32:07,888 INFO] Validation perplexity: 3.89051
[2021-02-19 20:32:07,888 INFO] Validation accuracy: 70.897
[2021-02-19 20:32:07,888 INFO] Model is improving ppl: 4.11482 --> 3.89051.
[2021-02-19 20:32:07,888 INFO] Model is improving acc: 70.0649 --> 70.897.
[2021-02-19 20:32:08,113 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_3500.pt
[2021-02-19 20:34:21,956 INFO] Step 3600/202000; acc:  70.28; ppl:  3.37; xent: 1.21; lr: 0.00147; 21111/24271 tok/s;   4872 sec
[2021-02-19 20:36:34,241 INFO] Step 3700/202000; acc:  70.67; ppl:  3.30; xent: 1.19; lr: 0.00145; 23042/26492 tok/s;   5004 sec
[2021-02-19 20:38:08,426 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 20:38:30,109 INFO] number of examples: 878269
[2021-02-19 20:38:46,636 INFO] Step 3800/202000; acc:  70.79; ppl:  3.27; xent: 1.19; lr: 0.00143; 23188/26513 tok/s;   5136 sec
[2021-02-19 20:40:59,074 INFO] Step 3900/202000; acc:  70.87; ppl:  3.25; xent: 1.18; lr: 0.00142; 23025/26485 tok/s;   5269 sec
[2021-02-19 20:43:11,503 INFO] Step 4000/202000; acc:  71.03; ppl:  3.22; xent: 1.17; lr: 0.00140; 23178/26546 tok/s;   5401 sec
[2021-02-19 20:43:11,504 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 20:43:11,554 INFO] number of examples: 6594
[2021-02-19 20:43:21,098 INFO] Validation perplexity: 3.75711
[2021-02-19 20:43:21,098 INFO] Validation accuracy: 71.4439
[2021-02-19 20:43:21,098 INFO] Model is improving ppl: 3.89051 --> 3.75711.
[2021-02-19 20:43:21,098 INFO] Model is improving acc: 70.897 --> 71.4439.
[2021-02-19 20:43:21,322 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_4000.pt
[2021-02-19 20:45:34,926 INFO] Step 4100/202000; acc:  71.11; ppl:  3.20; xent: 1.16; lr: 0.00138; 21294/24554 tok/s;   5545 sec
[2021-02-19 20:47:47,532 INFO] Step 4200/202000; acc:  71.43; ppl:  3.15; xent: 1.15; lr: 0.00136; 23130/26596 tok/s;   5677 sec
[2021-02-19 20:50:00,211 INFO] Step 4300/202000; acc:  71.65; ppl:  3.11; xent: 1.13; lr: 0.00135; 23254/26520 tok/s;   5810 sec
[2021-02-19 20:52:13,030 INFO] Step 4400/202000; acc:  71.67; ppl:  3.10; xent: 1.13; lr: 0.00133; 23043/26557 tok/s;   5943 sec
[2021-02-19 20:53:02,484 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 20:53:14,352 INFO] number of examples: 410180
[2021-02-19 20:54:26,272 INFO] Step 4500/202000; acc:  71.77; ppl:  3.08; xent: 1.12; lr: 0.00132; 22873/26191 tok/s;   6076 sec
[2021-02-19 20:54:26,273 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 20:54:26,375 INFO] number of examples: 6594
[2021-02-19 20:54:35,830 INFO] Validation perplexity: 3.63868
[2021-02-19 20:54:35,830 INFO] Validation accuracy: 71.9363
[2021-02-19 20:54:35,830 INFO] Model is improving ppl: 3.75711 --> 3.63868.
[2021-02-19 20:54:35,830 INFO] Model is improving acc: 71.4439 --> 71.9363.
[2021-02-19 20:54:36,051 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_4500.pt
[2021-02-19 20:56:49,929 INFO] Step 4600/202000; acc:  71.92; ppl:  3.06; xent: 1.12; lr: 0.00130; 21105/24308 tok/s;   6220 sec
[2021-02-19 20:59:02,392 INFO] Step 4700/202000; acc:  72.03; ppl:  3.03; xent: 1.11; lr: 0.00129; 23015/26357 tok/s;   6352 sec
[2021-02-19 21:00:06,380 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 21:00:26,383 INFO] number of examples: 878269
[2021-02-19 21:01:15,327 INFO] Step 4800/202000; acc:  72.21; ppl:  3.01; xent: 1.10; lr: 0.00128; 23068/26534 tok/s;   6485 sec
[2021-02-19 21:03:27,547 INFO] Step 4900/202000; acc:  72.34; ppl:  2.98; xent: 1.09; lr: 0.00126; 23149/26501 tok/s;   6617 sec
[2021-02-19 21:05:39,878 INFO] Step 5000/202000; acc:  72.26; ppl:  2.99; xent: 1.09; lr: 0.00125; 23153/26444 tok/s;   6750 sec
[2021-02-19 21:05:39,879 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 21:05:39,929 INFO] number of examples: 6594
[2021-02-19 21:05:49,481 INFO] Validation perplexity: 3.60146
[2021-02-19 21:05:49,481 INFO] Validation accuracy: 72.1158
[2021-02-19 21:05:49,481 INFO] Model is improving ppl: 3.63868 --> 3.60146.
[2021-02-19 21:05:49,481 INFO] Model is improving acc: 71.9363 --> 72.1158.
[2021-02-19 21:05:49,703 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_5000.pt
[2021-02-19 21:08:03,449 INFO] Step 5100/202000; acc:  72.49; ppl:  2.95; xent: 1.08; lr: 0.00124; 21310/24682 tok/s;   6893 sec
[2021-02-19 21:10:15,803 INFO] Step 5200/202000; acc:  72.68; ppl:  2.92; xent: 1.07; lr: 0.00123; 23231/26631 tok/s;   7025 sec
[2021-02-19 21:12:28,365 INFO] Step 5300/202000; acc:  72.84; ppl:  2.90; xent: 1.07; lr: 0.00121; 23205/26587 tok/s;   7158 sec
[2021-02-19 21:14:41,113 INFO] Step 5400/202000; acc:  72.79; ppl:  2.90; xent: 1.07; lr: 0.00120; 23041/26425 tok/s;   7291 sec
[2021-02-19 21:14:58,873 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 21:15:08,700 INFO] number of examples: 410180
[2021-02-19 21:16:53,694 INFO] Step 5500/202000; acc:  72.87; ppl:  2.88; xent: 1.06; lr: 0.00119; 22894/26323 tok/s;   7423 sec
[2021-02-19 21:16:53,695 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 21:16:53,795 INFO] number of examples: 6594
[2021-02-19 21:17:03,259 INFO] Validation perplexity: 3.51498
[2021-02-19 21:17:03,259 INFO] Validation accuracy: 72.6021
[2021-02-19 21:17:03,259 INFO] Model is improving ppl: 3.60146 --> 3.51498.
[2021-02-19 21:17:03,259 INFO] Model is improving acc: 72.1158 --> 72.6021.
[2021-02-19 21:17:03,481 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_5500.pt
[2021-02-19 21:19:17,242 INFO] Step 5600/202000; acc:  73.00; ppl:  2.87; xent: 1.06; lr: 0.00118; 21079/24328 tok/s;   7567 sec
[2021-02-19 21:21:29,698 INFO] Step 5700/202000; acc:  73.10; ppl:  2.85; xent: 1.05; lr: 0.00117; 23148/26432 tok/s;   7699 sec
[2021-02-19 21:22:01,683 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 21:22:23,473 INFO] number of examples: 878269
[2021-02-19 21:23:42,040 INFO] Step 5800/202000; acc:  73.32; ppl:  2.82; xent: 1.04; lr: 0.00116; 23128/26622 tok/s;   7832 sec
[2021-02-19 21:25:54,034 INFO] Step 5900/202000; acc:  73.18; ppl:  2.84; xent: 1.04; lr: 0.00115; 23079/26493 tok/s;   7964 sec
[2021-02-19 21:28:06,011 INFO] Step 6000/202000; acc:  73.35; ppl:  2.81; xent: 1.03; lr: 0.00114; 23238/26664 tok/s;   8096 sec
[2021-02-19 21:28:06,012 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 21:28:06,063 INFO] number of examples: 6594
[2021-02-19 21:28:15,612 INFO] Validation perplexity: 3.48133
[2021-02-19 21:28:15,612 INFO] Validation accuracy: 72.7764
[2021-02-19 21:28:15,612 INFO] Model is improving ppl: 3.51498 --> 3.48133.
[2021-02-19 21:28:15,612 INFO] Model is improving acc: 72.6021 --> 72.7764.
[2021-02-19 21:28:15,835 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_6000.pt
[2021-02-19 21:30:29,703 INFO] Step 6100/202000; acc:  73.38; ppl:  2.80; xent: 1.03; lr: 0.00113; 21415/24610 tok/s;   8239 sec
[2021-02-19 21:32:42,382 INFO] Step 6200/202000; acc:  73.63; ppl:  2.77; xent: 1.02; lr: 0.00112; 23179/26543 tok/s;   8372 sec
[2021-02-19 21:34:55,054 INFO] Step 6300/202000; acc:  73.65; ppl:  2.77; xent: 1.02; lr: 0.00111; 23113/26572 tok/s;   8505 sec
[2021-02-19 21:36:54,868 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 21:37:02,893 INFO] number of examples: 410180
[2021-02-19 21:37:07,752 INFO] Step 6400/202000; acc:  73.80; ppl:  2.75; xent: 1.01; lr: 0.00110; 23064/26378 tok/s;   8637 sec
[2021-02-19 21:39:20,441 INFO] Step 6500/202000; acc:  73.68; ppl:  2.76; xent: 1.01; lr: 0.00110; 22816/26280 tok/s;   8770 sec
[2021-02-19 21:39:20,442 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 21:39:20,539 INFO] number of examples: 6594
[2021-02-19 21:39:30,008 INFO] Validation perplexity: 3.42793
[2021-02-19 21:39:30,008 INFO] Validation accuracy: 72.9894
[2021-02-19 21:39:30,008 INFO] Model is improving ppl: 3.48133 --> 3.42793.
[2021-02-19 21:39:30,008 INFO] Model is improving acc: 72.7764 --> 72.9894.
[2021-02-19 21:39:30,229 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_6500.pt
[2021-02-19 21:41:44,419 INFO] Step 6600/202000; acc:  73.89; ppl:  2.73; xent: 1.00; lr: 0.00109; 21131/24339 tok/s;   8914 sec
[2021-02-19 21:43:56,900 INFO] Step 6700/202000; acc:  74.00; ppl:  2.72; xent: 1.00; lr: 0.00108; 23131/26422 tok/s;   9047 sec
[2021-02-19 21:43:57,019 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 21:44:20,266 INFO] number of examples: 878269
[2021-02-19 21:46:09,434 INFO] Step 6800/202000; acc:  74.02; ppl:  2.71; xent: 1.00; lr: 0.00107; 23100/26498 tok/s;   9179 sec
[2021-02-19 21:48:21,644 INFO] Step 6900/202000; acc:  73.98; ppl:  2.71; xent: 1.00; lr: 0.00106; 23086/26513 tok/s;   9311 sec
[2021-02-19 21:50:33,910 INFO] Step 7000/202000; acc:  74.15; ppl:  2.69; xent: 0.99; lr: 0.00106; 23178/26629 tok/s;   9444 sec
[2021-02-19 21:50:33,910 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 21:50:33,961 INFO] number of examples: 6594
[2021-02-19 21:50:43,524 INFO] Validation perplexity: 3.40695
[2021-02-19 21:50:43,524 INFO] Validation accuracy: 73.0714
[2021-02-19 21:50:43,524 INFO] Model is improving ppl: 3.42793 --> 3.40695.
[2021-02-19 21:50:43,524 INFO] Model is improving acc: 72.9894 --> 73.0714.
[2021-02-19 21:50:43,748 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_7000.pt
[2021-02-19 21:52:57,564 INFO] Step 7100/202000; acc:  74.10; ppl:  2.69; xent: 0.99; lr: 0.00105; 21392/24593 tok/s;   9587 sec
[2021-02-19 21:55:10,212 INFO] Step 7200/202000; acc:  74.40; ppl:  2.66; xent: 0.98; lr: 0.00104; 23163/26550 tok/s;   9720 sec
[2021-02-19 21:57:22,933 INFO] Step 7300/202000; acc:  74.55; ppl:  2.64; xent: 0.97; lr: 0.00103; 23109/26651 tok/s;   9853 sec
[2021-02-19 21:58:51,058 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 21:58:58,856 INFO] number of examples: 410180
[2021-02-19 21:59:35,893 INFO] Step 7400/202000; acc:  74.43; ppl:  2.65; xent: 0.97; lr: 0.00103; 22957/26197 tok/s;   9986 sec
[2021-02-19 22:01:48,820 INFO] Step 7500/202000; acc:  74.45; ppl:  2.65; xent: 0.97; lr: 0.00102; 22765/26228 tok/s;  10118 sec
[2021-02-19 22:01:48,821 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:01:48,915 INFO] number of examples: 6594
[2021-02-19 22:01:58,381 INFO] Validation perplexity: 3.39396
[2021-02-19 22:01:58,381 INFO] Validation accuracy: 73.2569
[2021-02-19 22:01:58,381 INFO] Model is improving ppl: 3.40695 --> 3.39396.
[2021-02-19 22:01:58,381 INFO] Model is improving acc: 73.0714 --> 73.2569.
[2021-02-19 22:01:58,603 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_7500.pt
[2021-02-19 22:04:12,893 INFO] Step 7600/202000; acc:  74.60; ppl:  2.63; xent: 0.97; lr: 0.00101; 21151/24314 tok/s;  10263 sec
[2021-02-19 22:05:54,894 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 22:06:18,296 INFO] number of examples: 878269
[2021-02-19 22:06:25,177 INFO] Step 7700/202000; acc:  74.70; ppl:  2.61; xent: 0.96; lr: 0.00101; 23215/26543 tok/s;  10395 sec
[2021-02-19 22:08:38,087 INFO] Step 7800/202000; acc:  74.64; ppl:  2.62; xent: 0.96; lr: 0.00100; 22979/26415 tok/s;  10528 sec
[2021-02-19 22:10:50,509 INFO] Step 7900/202000; acc:  74.71; ppl:  2.61; xent: 0.96; lr: 0.00099; 23142/26536 tok/s;  10660 sec
[2021-02-19 22:13:02,912 INFO] Step 8000/202000; acc:  74.75; ppl:  2.60; xent: 0.96; lr: 0.00099; 23096/26576 tok/s;  10793 sec
[2021-02-19 22:13:02,913 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:13:03,020 INFO] number of examples: 6594
[2021-02-19 22:13:12,507 INFO] Validation perplexity: 3.3687
[2021-02-19 22:13:12,507 INFO] Validation accuracy: 73.3299
[2021-02-19 22:13:12,507 INFO] Model is improving ppl: 3.39396 --> 3.3687.
[2021-02-19 22:13:12,507 INFO] Model is improving acc: 73.2569 --> 73.3299.
[2021-02-19 22:13:12,731 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_8000.pt
[2021-02-19 22:15:26,350 INFO] Step 8100/202000; acc:  74.88; ppl:  2.59; xent: 0.95; lr: 0.00098; 21382/24590 tok/s;  10936 sec
[2021-02-19 22:17:38,707 INFO] Step 8200/202000; acc:  75.03; ppl:  2.57; xent: 0.94; lr: 0.00098; 23254/26565 tok/s;  11068 sec
[2021-02-19 22:19:51,563 INFO] Step 8300/202000; acc:  75.05; ppl:  2.56; xent: 0.94; lr: 0.00097; 23119/26608 tok/s;  11201 sec
[2021-02-19 22:20:47,721 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 22:20:59,704 INFO] number of examples: 410180
[2021-02-19 22:22:04,215 INFO] Step 8400/202000; acc:  75.05; ppl:  2.56; xent: 0.94; lr: 0.00096; 22951/26283 tok/s;  11334 sec
[2021-02-19 22:24:16,849 INFO] Step 8500/202000; acc:  75.13; ppl:  2.56; xent: 0.94; lr: 0.00096; 22846/26301 tok/s;  11467 sec
[2021-02-19 22:24:16,850 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:24:16,903 INFO] number of examples: 6594
[2021-02-19 22:24:26,399 INFO] Validation perplexity: 3.34998
[2021-02-19 22:24:26,399 INFO] Validation accuracy: 73.4721
[2021-02-19 22:24:26,399 INFO] Model is improving ppl: 3.3687 --> 3.34998.
[2021-02-19 22:24:26,399 INFO] Model is improving acc: 73.3299 --> 73.4721.
[2021-02-19 22:24:26,622 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_8500.pt
[2021-02-19 22:26:40,302 INFO] Step 8600/202000; acc:  75.19; ppl:  2.55; xent: 0.93; lr: 0.00095; 21297/24383 tok/s;  11610 sec
[2021-02-19 22:27:50,482 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 22:28:09,967 INFO] number of examples: 878269
[2021-02-19 22:28:52,971 INFO] Step 8700/202000; acc:  75.26; ppl:  2.54; xent: 0.93; lr: 0.00095; 23098/26550 tok/s;  11743 sec
[2021-02-19 22:31:04,833 INFO] Step 8800/202000; acc:  75.25; ppl:  2.54; xent: 0.93; lr: 0.00094; 23158/26553 tok/s;  11874 sec
[2021-02-19 22:33:17,008 INFO] Step 8900/202000; acc:  75.20; ppl:  2.54; xent: 0.93; lr: 0.00094; 23170/26560 tok/s;  12007 sec
[2021-02-19 22:35:29,493 INFO] Step 9000/202000; acc:  75.34; ppl:  2.52; xent: 0.93; lr: 0.00093; 23124/26676 tok/s;  12139 sec
[2021-02-19 22:35:29,494 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:35:29,597 INFO] number of examples: 6594
[2021-02-19 22:35:39,102 INFO] Validation perplexity: 3.33554
[2021-02-19 22:35:39,102 INFO] Validation accuracy: 73.4844
[2021-02-19 22:35:39,102 INFO] Model is improving ppl: 3.34998 --> 3.33554.
[2021-02-19 22:35:39,102 INFO] Model is improving acc: 73.4721 --> 73.4844.
[2021-02-19 22:35:39,325 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_9000.pt
[2021-02-19 22:37:53,135 INFO] Step 9100/202000; acc:  75.50; ppl:  2.51; xent: 0.92; lr: 0.00093; 21397/24532 tok/s;  12283 sec
[2021-02-19 22:40:05,892 INFO] Step 9200/202000; acc:  75.57; ppl:  2.50; xent: 0.92; lr: 0.00092; 23144/26559 tok/s;  12416 sec
[2021-02-19 22:42:18,735 INFO] Step 9300/202000; acc:  75.54; ppl:  2.50; xent: 0.92; lr: 0.00092; 23086/26455 tok/s;  12548 sec
[2021-02-19 22:42:44,056 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 22:42:51,305 INFO] number of examples: 410180
[2021-02-19 22:44:31,587 INFO] Step 9400/202000; acc:  75.56; ppl:  2.50; xent: 0.91; lr: 0.00091; 22824/26258 tok/s;  12681 sec
[2021-02-19 22:46:43,892 INFO] Step 9500/202000; acc:  75.63; ppl:  2.49; xent: 0.91; lr: 0.00091; 22847/26363 tok/s;  12814 sec
[2021-02-19 22:46:43,892 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:46:43,945 INFO] number of examples: 6594
[2021-02-19 22:46:53,501 INFO] Validation perplexity: 3.34197
[2021-02-19 22:46:53,501 INFO] Validation accuracy: 73.5086
[2021-02-19 22:46:53,501 INFO] Stalled patience: 4/5
[2021-02-19 22:46:53,723 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_9500.pt
[2021-02-19 22:49:07,515 INFO] Step 9600/202000; acc:  75.65; ppl:  2.49; xent: 0.91; lr: 0.00090; 21366/24361 tok/s;  12957 sec
[2021-02-19 22:49:46,087 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 22:50:05,278 INFO] number of examples: 878269
[2021-02-19 22:51:20,371 INFO] Step 9700/202000; acc:  75.85; ppl:  2.46; xent: 0.90; lr: 0.00090; 23063/26541 tok/s;  13090 sec
[2021-02-19 22:53:32,672 INFO] Step 9800/202000; acc:  75.71; ppl:  2.48; xent: 0.91; lr: 0.00089; 23043/26468 tok/s;  13222 sec
[2021-02-19 22:55:45,154 INFO] Step 9900/202000; acc:  75.73; ppl:  2.47; xent: 0.90; lr: 0.00089; 23125/26496 tok/s;  13355 sec
[2021-02-19 22:57:57,714 INFO] Step 10000/202000; acc:  75.77; ppl:  2.47; xent: 0.90; lr: 0.00088; 23186/26695 tok/s;  13487 sec
[2021-02-19 22:57:57,714 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 22:57:57,814 INFO] number of examples: 6594
[2021-02-19 22:58:07,289 INFO] Validation perplexity: 3.31691
[2021-02-19 22:58:07,289 INFO] Validation accuracy: 73.5702
[2021-02-19 22:58:07,289 INFO] Model is improving ppl: 3.33554 --> 3.31691.
[2021-02-19 22:58:07,289 INFO] Model is improving acc: 73.4844 --> 73.5702.
[2021-02-19 22:58:07,511 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_10000.pt
[2021-02-19 23:00:21,421 INFO] Step 10100/202000; acc:  76.02; ppl:  2.44; xent: 0.89; lr: 0.00088; 21370/24499 tok/s;  13631 sec
[2021-02-19 23:02:34,141 INFO] Step 10200/202000; acc:  76.00; ppl:  2.44; xent: 0.89; lr: 0.00088; 23120/26576 tok/s;  13764 sec
[2021-02-19 23:04:40,569 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 23:04:47,063 INFO] Step 10300/202000; acc:  76.02; ppl:  2.44; xent: 0.89; lr: 0.00087; 23033/26350 tok/s;  13897 sec
[2021-02-19 23:04:50,587 INFO] number of examples: 410180
[2021-02-19 23:07:00,120 INFO] Step 10400/202000; acc:  75.99; ppl:  2.44; xent: 0.89; lr: 0.00087; 22789/26207 tok/s;  14030 sec
[2021-02-19 23:09:12,995 INFO] Step 10500/202000; acc:  76.16; ppl:  2.42; xent: 0.89; lr: 0.00086; 22866/26376 tok/s;  14163 sec
[2021-02-19 23:09:12,995 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 23:09:13,049 INFO] number of examples: 6594
[2021-02-19 23:09:22,622 INFO] Validation perplexity: 3.32437
[2021-02-19 23:09:22,622 INFO] Validation accuracy: 73.6296
[2021-02-19 23:09:22,622 INFO] Stalled patience: 4/5
[2021-02-19 23:09:22,844 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_10500.pt
[2021-02-19 23:11:36,371 INFO] Step 10600/202000; acc:  76.20; ppl:  2.42; xent: 0.88; lr: 0.00086; 21379/24369 tok/s;  14306 sec
[2021-02-19 23:11:44,410 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 23:12:06,135 INFO] number of examples: 878269
[2021-02-19 23:13:48,984 INFO] Step 10700/202000; acc:  76.24; ppl:  2.41; xent: 0.88; lr: 0.00085; 23091/26557 tok/s;  14439 sec
[2021-02-19 23:16:01,332 INFO] Step 10800/202000; acc:  76.07; ppl:  2.43; xent: 0.89; lr: 0.00085; 23064/26456 tok/s;  14571 sec
[2021-02-19 23:18:13,704 INFO] Step 10900/202000; acc:  76.27; ppl:  2.41; xent: 0.88; lr: 0.00085; 23135/26584 tok/s;  14703 sec
[2021-02-19 23:20:25,944 INFO] Step 11000/202000; acc:  76.16; ppl:  2.42; xent: 0.88; lr: 0.00084; 23235/26716 tok/s;  14836 sec
[2021-02-19 23:20:25,945 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 23:20:26,048 INFO] number of examples: 6594
[2021-02-19 23:20:35,503 INFO] Validation perplexity: 3.2884
[2021-02-19 23:20:35,503 INFO] Validation accuracy: 73.6638
[2021-02-19 23:20:35,503 INFO] Model is improving ppl: 3.31691 --> 3.2884.
[2021-02-19 23:20:35,503 INFO] Model is improving acc: 73.5702 --> 73.6638.
[2021-02-19 23:20:35,729 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_11000.pt
[2021-02-19 23:22:49,650 INFO] Step 11100/202000; acc:  76.48; ppl:  2.39; xent: 0.87; lr: 0.00084; 21395/24520 tok/s;  14979 sec
[2021-02-19 23:25:02,306 INFO] Step 11200/202000; acc:  76.49; ppl:  2.39; xent: 0.87; lr: 0.00084; 23154/26637 tok/s;  15112 sec
[2021-02-19 23:26:36,835 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 23:26:43,787 INFO] number of examples: 410180
[2021-02-19 23:27:15,070 INFO] Step 11300/202000; acc:  76.50; ppl:  2.39; xent: 0.87; lr: 0.00083; 22955/26267 tok/s;  15245 sec
[2021-02-19 23:29:27,747 INFO] Step 11400/202000; acc:  76.42; ppl:  2.39; xent: 0.87; lr: 0.00083; 22838/26282 tok/s;  15377 sec
[2021-02-19 23:31:40,002 INFO] Step 11500/202000; acc:  76.60; ppl:  2.37; xent: 0.86; lr: 0.00082; 23013/26458 tok/s;  15510 sec
[2021-02-19 23:31:40,003 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 23:31:40,055 INFO] number of examples: 6594
[2021-02-19 23:31:49,613 INFO] Validation perplexity: 3.31644
[2021-02-19 23:31:49,613 INFO] Validation accuracy: 73.6701
[2021-02-19 23:31:49,613 INFO] Stalled patience: 4/5
[2021-02-19 23:31:49,840 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_11500.pt
[2021-02-19 23:33:39,833 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 23:34:02,067 INFO] number of examples: 878269
[2021-02-19 23:34:03,417 INFO] Step 11600/202000; acc:  76.61; ppl:  2.37; xent: 0.86; lr: 0.00082; 21389/24476 tok/s;  15653 sec
[2021-02-19 23:36:15,869 INFO] Step 11700/202000; acc:  76.60; ppl:  2.37; xent: 0.86; lr: 0.00082; 23081/26536 tok/s;  15786 sec
[2021-02-19 23:38:28,259 INFO] Step 11800/202000; acc:  76.58; ppl:  2.37; xent: 0.86; lr: 0.00081; 23185/26531 tok/s;  15918 sec
[2021-02-19 23:40:40,687 INFO] Step 11900/202000; acc:  76.58; ppl:  2.37; xent: 0.86; lr: 0.00081; 23067/26565 tok/s;  16050 sec
[2021-02-19 23:42:53,332 INFO] Step 12000/202000; acc:  76.70; ppl:  2.36; xent: 0.86; lr: 0.00081; 23145/26590 tok/s;  16183 sec
[2021-02-19 23:42:53,333 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 23:42:53,428 INFO] number of examples: 6594
[2021-02-19 23:43:02,900 INFO] Validation perplexity: 3.29376
[2021-02-19 23:43:02,900 INFO] Validation accuracy: 73.6764
[2021-02-19 23:43:02,900 INFO] Stalled patience: 3/5
[2021-02-19 23:43:03,122 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_12000.pt
[2021-02-19 23:45:17,209 INFO] Step 12100/202000; acc:  76.82; ppl:  2.35; xent: 0.85; lr: 0.00080; 21380/24434 tok/s;  16327 sec
[2021-02-19 23:47:29,905 INFO] Step 12200/202000; acc:  76.88; ppl:  2.34; xent: 0.85; lr: 0.00080; 23114/26700 tok/s;  16460 sec
[2021-02-19 23:48:33,799 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 23:48:41,093 INFO] number of examples: 410180
[2021-02-19 23:49:42,781 INFO] Step 12300/202000; acc:  76.87; ppl:  2.34; xent: 0.85; lr: 0.00080; 22929/26199 tok/s;  16592 sec
[2021-02-19 23:51:55,476 INFO] Step 12400/202000; acc:  76.87; ppl:  2.34; xent: 0.85; lr: 0.00079; 22819/26288 tok/s;  16725 sec
[2021-02-19 23:54:08,111 INFO] Step 12500/202000; acc:  76.93; ppl:  2.33; xent: 0.85; lr: 0.00079; 23058/26397 tok/s;  16858 sec
[2021-02-19 23:54:08,112 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 23:54:08,218 INFO] number of examples: 6594
[2021-02-19 23:54:17,736 INFO] Validation perplexity: 3.31669
[2021-02-19 23:54:17,736 INFO] Validation accuracy: 73.7801
[2021-02-19 23:54:17,736 INFO] Stalled patience: 2/5
[2021-02-19 23:54:17,958 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_12500.pt
[2021-02-19 23:55:36,142 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 23:55:56,420 INFO] number of examples: 878269
[2021-02-19 23:56:31,935 INFO] Step 12600/202000; acc:  76.96; ppl:  2.33; xent: 0.85; lr: 0.00079; 21320/24454 tok/s;  17002 sec
[2021-02-19 23:58:43,909 INFO] Step 12700/202000; acc:  76.98; ppl:  2.33; xent: 0.85; lr: 0.00078; 23096/26534 tok/s;  17134 sec
[2021-02-20 00:00:56,181 INFO] Step 12800/202000; acc:  76.94; ppl:  2.33; xent: 0.85; lr: 0.00078; 23165/26575 tok/s;  17266 sec
[2021-02-20 00:03:08,569 INFO] Step 12900/202000; acc:  76.99; ppl:  2.33; xent: 0.84; lr: 0.00078; 23125/26677 tok/s;  17398 sec
[2021-02-20 00:05:21,099 INFO] Step 13000/202000; acc:  77.17; ppl:  2.31; xent: 0.84; lr: 0.00078; 23178/26555 tok/s;  17531 sec
[2021-02-20 00:05:21,099 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-20 00:05:21,151 INFO] number of examples: 6594
[2021-02-20 00:05:30,656 INFO] Validation perplexity: 3.3129
[2021-02-20 00:05:30,657 INFO] Validation accuracy: 73.7939
[2021-02-20 00:05:30,657 INFO] Stalled patience: 1/5
[2021-02-20 00:05:30,879 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_13000.pt
[2021-02-20 00:07:45,000 INFO] Step 13100/202000; acc:  77.18; ppl:  2.31; xent: 0.84; lr: 0.00077; 21377/24491 tok/s;  17675 sec
[2021-02-20 00:09:58,280 INFO] Step 13200/202000; acc:  77.18; ppl:  2.31; xent: 0.84; lr: 0.00077; 23022/26396 tok/s;  17808 sec
[2021-02-20 00:10:30,105 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-20 00:10:37,310 INFO] number of examples: 410180
[2021-02-20 00:12:11,150 INFO] Step 13300/202000; acc:  77.23; ppl:  2.30; xent: 0.83; lr: 0.00077; 22860/26265 tok/s;  17941 sec
[2021-02-20 00:14:23,622 INFO] Step 13400/202000; acc:  77.29; ppl:  2.30; xent: 0.83; lr: 0.00076; 22810/26370 tok/s;  18073 sec
[2021-02-20 00:16:36,122 INFO] Step 13500/202000; acc:  77.24; ppl:  2.30; xent: 0.83; lr: 0.00076; 23128/26355 tok/s;  18206 sec
[2021-02-20 00:16:36,123 INFO] Loading dataset from /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-20 00:16:36,226 INFO] number of examples: 6594
[2021-02-20 00:16:45,736 INFO] Validation perplexity: 3.31339
[2021-02-20 00:16:45,736 INFO] Validation accuracy: 73.7831
[2021-02-20 00:16:45,736 INFO] Stalled patience: 0/5
[2021-02-20 00:16:45,736 INFO] Training finished after stalled validations. Early Stop!
[2021-02-20 00:16:45,736 INFO] Best model found at step 11000
[2021-02-20 00:16:45,971 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/EN-FR-TRANS-BPE/model/model_step_13500.pt

[2021-02-19 14:16:43,957 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 14:16:44,922 INFO]  * src vocab size = 47976
[2021-02-19 14:16:44,922 INFO]  * tgt vocab size = 46942
[2021-02-19 14:16:44,922 INFO] Building model...
[2021-02-19 14:16:50,336 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(47976, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(46942, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=512, out_features=46942, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2021-02-19 14:16:50,339 INFO] encoder: 43479040
[2021-02-19 14:16:50,339 INFO] decoder: 73340766
[2021-02-19 14:16:50,339 INFO] * number of parameters: 116819806
[2021-02-19 14:16:50,348 INFO] Starting training on GPU: [0, 1, 2]
[2021-02-19 14:16:50,348 INFO] Start training loop and validate every 500 steps...
[2021-02-19 14:16:58,013 INFO] number of examples: 878269
[2021-02-19 14:19:25,577 INFO] Step 100/202000; acc:   5.25; ppl: 3592.27; xent: 8.19; lr: 0.00010; 21564/20320 tok/s;    155 sec
[2021-02-19 14:21:31,569 INFO] Step 200/202000; acc:   9.42; ppl: 308.71; xent: 5.73; lr: 0.00020; 26443/24845 tok/s;    281 sec
[2021-02-19 14:23:39,086 INFO] Step 300/202000; acc:  17.10; ppl: 160.18; xent: 5.08; lr: 0.00030; 26176/24719 tok/s;    409 sec
[2021-02-19 14:25:45,677 INFO] Step 400/202000; acc:  22.67; ppl: 92.94; xent: 4.53; lr: 0.00040; 26313/25077 tok/s;    535 sec
[2021-02-19 14:27:52,186 INFO] Step 500/202000; acc:  26.51; ppl: 66.85; xent: 4.20; lr: 0.00050; 26338/24820 tok/s;    662 sec
[2021-02-19 14:27:52,187 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 14:27:52,246 INFO] number of examples: 6594
[2021-02-19 14:28:01,490 INFO] Validation perplexity: 96.4833
[2021-02-19 14:28:01,491 INFO] Validation accuracy: 29.0683
[2021-02-19 14:28:01,491 INFO] Model is improving acc: -inf --> 29.0683.
[2021-02-19 14:28:01,491 INFO] Model is improving ppl: inf --> 96.4833.
[2021-02-19 14:28:01,714 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_500.pt
[2021-02-19 14:28:57,886 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 14:29:08,874 INFO] number of examples: 410180
[2021-02-19 14:30:10,976 INFO] Step 600/202000; acc:  30.69; ppl: 48.09; xent: 3.87; lr: 0.00059; 23826/22507 tok/s;    801 sec
[2021-02-19 14:32:17,867 INFO] Step 700/202000; acc:  35.73; ppl: 33.94; xent: 3.52; lr: 0.00069; 26016/24565 tok/s;    928 sec
[2021-02-19 14:34:24,721 INFO] Step 800/202000; acc:  41.40; ppl: 23.14; xent: 3.14; lr: 0.00079; 26058/24754 tok/s;   1054 sec
[2021-02-19 14:35:38,486 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 14:36:01,060 INFO] number of examples: 878269
[2021-02-19 14:36:31,418 INFO] Step 900/202000; acc:  46.47; ppl: 16.50; xent: 2.80; lr: 0.00089; 26283/24687 tok/s;   1181 sec
[2021-02-19 14:38:38,689 INFO] Step 1000/202000; acc:  50.23; ppl: 12.75; xent: 2.55; lr: 0.00099; 26211/24700 tok/s;   1308 sec
[2021-02-19 14:38:38,690 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 14:38:38,799 INFO] number of examples: 6594
[2021-02-19 14:38:48,058 INFO] Validation perplexity: 13.5882
[2021-02-19 14:38:48,059 INFO] Validation accuracy: 53.9516
[2021-02-19 14:38:48,059 INFO] Model is improving acc: 29.0683 --> 53.9516.
[2021-02-19 14:38:48,059 INFO] Model is improving ppl: 96.4833 --> 13.5882.
[2021-02-19 14:38:48,281 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_1000.pt
[2021-02-19 14:40:57,412 INFO] Step 1100/202000; acc:  53.31; ppl: 10.34; xent: 2.34; lr: 0.00109; 24149/22720 tok/s;   1447 sec
[2021-02-19 14:43:03,567 INFO] Step 1200/202000; acc:  55.72; ppl:  8.78; xent: 2.17; lr: 0.00119; 26400/24877 tok/s;   1573 sec
[2021-02-19 14:45:10,930 INFO] Step 1300/202000; acc:  56.92; ppl:  8.06; xent: 2.09; lr: 0.00129; 26184/24721 tok/s;   1701 sec
[2021-02-19 14:47:17,464 INFO] Step 1400/202000; acc:  58.23; ppl:  7.35; xent: 1.99; lr: 0.00138; 26301/25018 tok/s;   1827 sec
[2021-02-19 14:49:23,918 INFO] Step 1500/202000; acc:  59.31; ppl:  6.83; xent: 1.92; lr: 0.00148; 26360/24917 tok/s;   1954 sec
[2021-02-19 14:49:23,919 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 14:49:23,980 INFO] number of examples: 6594
[2021-02-19 14:49:33,251 INFO] Validation perplexity: 7.52415
[2021-02-19 14:49:33,251 INFO] Validation accuracy: 61.5552
[2021-02-19 14:49:33,251 INFO] Model is improving acc: 53.9516 --> 61.5552.
[2021-02-19 14:49:33,251 INFO] Model is improving ppl: 13.5882 --> 7.52415.
[2021-02-19 14:49:33,474 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_1500.pt
[2021-02-19 14:50:19,054 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 14:50:32,679 INFO] number of examples: 410180
[2021-02-19 14:51:42,416 INFO] Step 1600/202000; acc:  59.94; ppl:  6.54; xent: 1.88; lr: 0.00158; 23828/22443 tok/s;   2092 sec
[2021-02-19 14:53:49,492 INFO] Step 1700/202000; acc:  60.72; ppl:  6.18; xent: 1.82; lr: 0.00168; 26055/24617 tok/s;   2219 sec
[2021-02-19 14:55:56,780 INFO] Step 1800/202000; acc:  61.34; ppl:  5.93; xent: 1.78; lr: 0.00178; 25940/24633 tok/s;   2346 sec
[2021-02-19 14:57:00,206 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 14:57:20,903 INFO] number of examples: 878269
[2021-02-19 14:58:03,191 INFO] Step 1900/202000; acc:  62.21; ppl:  5.61; xent: 1.72; lr: 0.00188; 26364/24762 tok/s;   2473 sec
[2021-02-19 15:00:10,189 INFO] Step 2000/202000; acc:  62.57; ppl:  5.47; xent: 1.70; lr: 0.00198; 26276/24767 tok/s;   2600 sec
[2021-02-19 15:00:10,190 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:00:10,288 INFO] number of examples: 6594
[2021-02-19 15:00:19,546 INFO] Validation perplexity: 6.06616
[2021-02-19 15:00:19,546 INFO] Validation accuracy: 64.429
[2021-02-19 15:00:19,547 INFO] Model is improving acc: 61.5552 --> 64.429.
[2021-02-19 15:00:19,547 INFO] Model is improving ppl: 7.52415 --> 6.06616.
[2021-02-19 15:00:19,767 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_2000.pt
[2021-02-19 15:02:28,396 INFO] Step 2100/202000; acc:  63.29; ppl:  5.22; xent: 1.65; lr: 0.00193; 24242/22754 tok/s;   2738 sec
[2021-02-19 15:04:34,778 INFO] Step 2200/202000; acc:  64.01; ppl:  4.97; xent: 1.60; lr: 0.00188; 26353/24842 tok/s;   2864 sec
[2021-02-19 15:06:42,532 INFO] Step 2300/202000; acc:  64.19; ppl:  4.89; xent: 1.59; lr: 0.00184; 26117/24706 tok/s;   2992 sec
[2021-02-19 15:08:49,310 INFO] Step 2400/202000; acc:  64.78; ppl:  4.71; xent: 1.55; lr: 0.00180; 26205/24920 tok/s;   3119 sec
[2021-02-19 15:10:56,552 INFO] Step 2500/202000; acc:  65.51; ppl:  4.51; xent: 1.51; lr: 0.00177; 26193/24788 tok/s;   3246 sec
[2021-02-19 15:10:56,553 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:10:56,603 INFO] number of examples: 6594
[2021-02-19 15:11:05,874 INFO] Validation perplexity: 5.17469
[2021-02-19 15:11:05,874 INFO] Validation accuracy: 66.8147
[2021-02-19 15:11:05,875 INFO] Model is improving acc: 64.429 --> 66.8147.
[2021-02-19 15:11:05,875 INFO] Model is improving ppl: 6.06616 --> 5.17469.
[2021-02-19 15:11:06,097 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_2500.pt
[2021-02-19 15:11:40,819 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 15:11:49,275 INFO] number of examples: 410180
[2021-02-19 15:13:14,754 INFO] Step 2600/202000; acc:  65.46; ppl:  4.50; xent: 1.50; lr: 0.00173; 23872/22488 tok/s;   3384 sec
[2021-02-19 15:15:21,282 INFO] Step 2700/202000; acc:  66.13; ppl:  4.32; xent: 1.46; lr: 0.00170; 26175/24696 tok/s;   3511 sec
[2021-02-19 15:17:28,391 INFO] Step 2800/202000; acc:  66.43; ppl:  4.24; xent: 1.44; lr: 0.00167; 25982/24639 tok/s;   3638 sec
[2021-02-19 15:18:21,707 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 15:18:45,952 INFO] number of examples: 878269
[2021-02-19 15:19:34,687 INFO] Step 2900/202000; acc:  66.83; ppl:  4.13; xent: 1.42; lr: 0.00164; 26398/24784 tok/s;   3764 sec
[2021-02-19 15:21:41,691 INFO] Step 3000/202000; acc:  66.98; ppl:  4.08; xent: 1.41; lr: 0.00161; 26286/24811 tok/s;   3891 sec
[2021-02-19 15:21:41,691 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:21:41,783 INFO] number of examples: 6594
[2021-02-19 15:21:51,042 INFO] Validation perplexity: 4.78743
[2021-02-19 15:21:51,043 INFO] Validation accuracy: 67.9522
[2021-02-19 15:21:51,043 INFO] Model is improving acc: 66.8147 --> 67.9522.
[2021-02-19 15:21:51,043 INFO] Model is improving ppl: 5.17469 --> 4.78743.
[2021-02-19 15:21:51,264 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_3000.pt
[2021-02-19 15:23:59,806 INFO] Step 3100/202000; acc:  67.47; ppl:  3.97; xent: 1.38; lr: 0.00159; 24298/22713 tok/s;   4029 sec
[2021-02-19 15:26:06,316 INFO] Step 3200/202000; acc:  67.58; ppl:  3.93; xent: 1.37; lr: 0.00156; 26308/24883 tok/s;   4156 sec
[2021-02-19 15:28:13,960 INFO] Step 3300/202000; acc:  67.56; ppl:  3.93; xent: 1.37; lr: 0.00154; 26118/24764 tok/s;   4284 sec
[2021-02-19 15:30:20,667 INFO] Step 3400/202000; acc:  67.82; ppl:  3.86; xent: 1.35; lr: 0.00152; 26219/24912 tok/s;   4410 sec
[2021-02-19 15:32:27,619 INFO] Step 3500/202000; acc:  68.25; ppl:  3.77; xent: 1.33; lr: 0.00149; 26201/24779 tok/s;   4537 sec
[2021-02-19 15:32:27,620 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:32:27,720 INFO] number of examples: 6594
[2021-02-19 15:32:36,979 INFO] Validation perplexity: 4.48755
[2021-02-19 15:32:36,979 INFO] Validation accuracy: 68.8121
[2021-02-19 15:32:36,979 INFO] Model is improving acc: 67.9522 --> 68.8121.
[2021-02-19 15:32:36,979 INFO] Model is improving ppl: 4.78743 --> 4.48755.
[2021-02-19 15:32:37,201 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_3500.pt
[2021-02-19 15:33:02,055 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 15:33:10,843 INFO] number of examples: 410180
[2021-02-19 15:34:45,884 INFO] Step 3600/202000; acc:  68.23; ppl:  3.77; xent: 1.33; lr: 0.00147; 23907/22542 tok/s;   4676 sec
[2021-02-19 15:36:52,765 INFO] Step 3700/202000; acc:  68.49; ppl:  3.71; xent: 1.31; lr: 0.00145; 26094/24636 tok/s;   4802 sec
[2021-02-19 15:39:00,035 INFO] Step 3800/202000; acc:  68.73; ppl:  3.66; xent: 1.30; lr: 0.00143; 25945/24596 tok/s;   4930 sec
[2021-02-19 15:39:43,424 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 15:40:04,270 INFO] number of examples: 878269
[2021-02-19 15:41:06,673 INFO] Step 3900/202000; acc:  68.89; ppl:  3.61; xent: 1.28; lr: 0.00142; 26336/24702 tok/s;   5056 sec
[2021-02-19 15:43:13,644 INFO] Step 4000/202000; acc:  68.97; ppl:  3.59; xent: 1.28; lr: 0.00140; 26305/24815 tok/s;   5183 sec
[2021-02-19 15:43:13,645 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:43:13,695 INFO] number of examples: 6594
[2021-02-19 15:43:22,987 INFO] Validation perplexity: 4.32906
[2021-02-19 15:43:22,987 INFO] Validation accuracy: 69.2953
[2021-02-19 15:43:22,987 INFO] Model is improving acc: 68.8121 --> 69.2953.
[2021-02-19 15:43:22,987 INFO] Model is improving ppl: 4.48755 --> 4.32906.
[2021-02-19 15:43:23,210 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_4000.pt
[2021-02-19 15:45:31,079 INFO] Step 4100/202000; acc:  69.35; ppl:  3.52; xent: 1.26; lr: 0.00138; 24391/22775 tok/s;   5321 sec
[2021-02-19 15:47:37,948 INFO] Step 4200/202000; acc:  69.29; ppl:  3.52; xent: 1.26; lr: 0.00136; 26227/24849 tok/s;   5448 sec
[2021-02-19 15:49:45,535 INFO] Step 4300/202000; acc:  69.31; ppl:  3.51; xent: 1.26; lr: 0.00135; 26170/24809 tok/s;   5575 sec
[2021-02-19 15:51:52,251 INFO] Step 4400/202000; acc:  69.46; ppl:  3.48; xent: 1.25; lr: 0.00133; 26213/24892 tok/s;   5702 sec
[2021-02-19 15:53:59,190 INFO] Step 4500/202000; acc:  69.88; ppl:  3.40; xent: 1.22; lr: 0.00132; 26127/24693 tok/s;   5829 sec
[2021-02-19 15:53:59,191 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 15:53:59,289 INFO] number of examples: 6594
[2021-02-19 15:54:08,519 INFO] Validation perplexity: 4.19339
[2021-02-19 15:54:08,519 INFO] Validation accuracy: 69.8271
[2021-02-19 15:54:08,519 INFO] Model is improving acc: 69.2953 --> 69.8271.
[2021-02-19 15:54:08,519 INFO] Model is improving ppl: 4.32906 --> 4.19339.
[2021-02-19 15:54:08,739 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_4500.pt
[2021-02-19 15:54:23,381 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 15:54:35,160 INFO] number of examples: 410180
[2021-02-19 15:56:17,364 INFO] Step 4600/202000; acc:  69.74; ppl:  3.42; xent: 1.23; lr: 0.00130; 23994/22624 tok/s;   5967 sec
[2021-02-19 15:58:24,282 INFO] Step 4700/202000; acc:  69.96; ppl:  3.38; xent: 1.22; lr: 0.00129; 26056/24658 tok/s;   6094 sec
[2021-02-19 16:00:31,480 INFO] Step 4800/202000; acc:  70.12; ppl:  3.35; xent: 1.21; lr: 0.00128; 25982/24602 tok/s;   6221 sec
[2021-02-19 16:01:04,517 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 16:01:28,783 INFO] number of examples: 878269
[2021-02-19 16:02:37,797 INFO] Step 4900/202000; acc:  70.26; ppl:  3.32; xent: 1.20; lr: 0.00126; 26380/24784 tok/s;   6347 sec
[2021-02-19 16:04:45,263 INFO] Step 5000/202000; acc:  70.28; ppl:  3.31; xent: 1.20; lr: 0.00125; 26218/24740 tok/s;   6475 sec
[2021-02-19 16:04:45,264 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:04:45,314 INFO] number of examples: 6594
[2021-02-19 16:04:54,614 INFO] Validation perplexity: 4.11188
[2021-02-19 16:04:54,614 INFO] Validation accuracy: 70.1337
[2021-02-19 16:04:54,614 INFO] Model is improving acc: 69.8271 --> 70.1337.
[2021-02-19 16:04:54,614 INFO] Model is improving ppl: 4.19339 --> 4.11188.
[2021-02-19 16:04:54,835 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_5000.pt
[2021-02-19 16:07:02,765 INFO] Step 5100/202000; acc:  70.61; ppl:  3.26; xent: 1.18; lr: 0.00124; 24379/22746 tok/s;   6612 sec
[2021-02-19 16:09:09,752 INFO] Step 5200/202000; acc:  70.52; ppl:  3.26; xent: 1.18; lr: 0.00123; 26217/24776 tok/s;   6739 sec
[2021-02-19 16:11:17,358 INFO] Step 5300/202000; acc:  70.43; ppl:  3.28; xent: 1.19; lr: 0.00121; 26102/24888 tok/s;   6867 sec
[2021-02-19 16:13:24,106 INFO] Step 5400/202000; acc:  70.73; ppl:  3.22; xent: 1.17; lr: 0.00120; 26263/24842 tok/s;   6994 sec
[2021-02-19 16:15:31,180 INFO] Step 5500/202000; acc:  71.02; ppl:  3.18; xent: 1.16; lr: 0.00119; 26079/24642 tok/s;   7121 sec
[2021-02-19 16:15:31,181 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:15:31,277 INFO] number of examples: 6594
[2021-02-19 16:15:40,509 INFO] Validation perplexity: 4.05057
[2021-02-19 16:15:40,509 INFO] Validation accuracy: 70.3435
[2021-02-19 16:15:40,509 INFO] Model is improving acc: 70.1337 --> 70.3435.
[2021-02-19 16:15:40,509 INFO] Model is improving ppl: 4.11188 --> 4.05057.
[2021-02-19 16:15:40,732 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_5500.pt
[2021-02-19 16:15:44,686 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 16:15:52,652 INFO] number of examples: 410180
[2021-02-19 16:17:49,315 INFO] Step 5600/202000; acc:  70.86; ppl:  3.20; xent: 1.16; lr: 0.00118; 23976/22613 tok/s;   7259 sec
[2021-02-19 16:19:56,009 INFO] Step 5700/202000; acc:  71.02; ppl:  3.17; xent: 1.15; lr: 0.00117; 26161/24695 tok/s;   7386 sec
[2021-02-19 16:22:03,364 INFO] Step 5800/202000; acc:  71.19; ppl:  3.14; xent: 1.14; lr: 0.00116; 25966/24598 tok/s;   7513 sec
[2021-02-19 16:22:26,215 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 16:22:51,446 INFO] number of examples: 878269
[2021-02-19 16:24:09,959 INFO] Step 5900/202000; acc:  71.28; ppl:  3.12; xent: 1.14; lr: 0.00115; 26283/24772 tok/s;   7640 sec
[2021-02-19 16:26:17,531 INFO] Step 6000/202000; acc:  71.24; ppl:  3.12; xent: 1.14; lr: 0.00114; 26197/24684 tok/s;   7767 sec
[2021-02-19 16:26:17,532 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:26:17,582 INFO] number of examples: 6594
[2021-02-19 16:26:26,879 INFO] Validation perplexity: 3.97821
[2021-02-19 16:26:26,880 INFO] Validation accuracy: 70.5649
[2021-02-19 16:26:26,880 INFO] Model is improving acc: 70.3435 --> 70.5649.
[2021-02-19 16:26:26,880 INFO] Model is improving ppl: 4.05057 --> 3.97821.
[2021-02-19 16:26:27,104 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_6000.pt
[2021-02-19 16:28:35,033 INFO] Step 6100/202000; acc:  71.47; ppl:  3.09; xent: 1.13; lr: 0.00113; 24354/22748 tok/s;   7905 sec
[2021-02-19 16:30:41,886 INFO] Step 6200/202000; acc:  71.61; ppl:  3.07; xent: 1.12; lr: 0.00112; 26290/24809 tok/s;   8032 sec
[2021-02-19 16:32:49,463 INFO] Step 6300/202000; acc:  71.44; ppl:  3.09; xent: 1.13; lr: 0.00111; 26064/24914 tok/s;   8159 sec
[2021-02-19 16:34:55,999 INFO] Step 6400/202000; acc:  71.52; ppl:  3.07; xent: 1.12; lr: 0.00110; 26343/24850 tok/s;   8286 sec
[2021-02-19 16:36:55,906 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 16:37:02,780 INFO] Step 6500/202000; acc:  71.88; ppl:  3.02; xent: 1.11; lr: 0.00110; 26087/24687 tok/s;   8412 sec
[2021-02-19 16:37:02,781 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:37:02,878 INFO] number of examples: 6594
[2021-02-19 16:37:04,431 INFO] number of examples: 410180
[2021-02-19 16:37:12,176 INFO] Validation perplexity: 3.91122
[2021-02-19 16:37:12,176 INFO] Validation accuracy: 70.756
[2021-02-19 16:37:12,176 INFO] Model is improving acc: 70.5649 --> 70.756.
[2021-02-19 16:37:12,176 INFO] Model is improving ppl: 3.97821 --> 3.91122.
[2021-02-19 16:37:12,399 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_6500.pt
[2021-02-19 16:39:20,992 INFO] Step 6600/202000; acc:  71.73; ppl:  3.04; xent: 1.11; lr: 0.00109; 23993/22593 tok/s;   8551 sec
[2021-02-19 16:41:27,752 INFO] Step 6700/202000; acc:  71.85; ppl:  3.02; xent: 1.11; lr: 0.00108; 26127/24721 tok/s;   8677 sec
[2021-02-19 16:43:35,369 INFO] Step 6800/202000; acc:  72.09; ppl:  2.98; xent: 1.09; lr: 0.00107; 25977/24550 tok/s;   8805 sec
[2021-02-19 16:43:48,127 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 16:44:11,943 INFO] number of examples: 878269
[2021-02-19 16:45:42,288 INFO] Step 6900/202000; acc:  72.13; ppl:  2.98; xent: 1.09; lr: 0.00106; 26193/24704 tok/s;   8932 sec
[2021-02-19 16:47:49,974 INFO] Step 7000/202000; acc:  71.94; ppl:  2.99; xent: 1.10; lr: 0.00106; 26172/24742 tok/s;   9060 sec
[2021-02-19 16:47:49,975 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:47:50,025 INFO] number of examples: 6594
[2021-02-19 16:47:59,320 INFO] Validation perplexity: 3.92937
[2021-02-19 16:47:59,321 INFO] Validation accuracy: 70.9149
[2021-02-19 16:47:59,321 INFO] Stalled patience: 4/5
[2021-02-19 16:47:59,546 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_7000.pt
[2021-02-19 16:50:07,434 INFO] Step 7100/202000; acc:  72.33; ppl:  2.94; xent: 1.08; lr: 0.00105; 24362/22683 tok/s;   9197 sec
[2021-02-19 16:52:14,401 INFO] Step 7200/202000; acc:  72.31; ppl:  2.94; xent: 1.08; lr: 0.00104; 26268/24775 tok/s;   9324 sec
[2021-02-19 16:54:21,670 INFO] Step 7300/202000; acc:  72.18; ppl:  2.96; xent: 1.09; lr: 0.00103; 26135/24996 tok/s;   9451 sec
[2021-02-19 16:56:28,334 INFO] Step 7400/202000; acc:  72.29; ppl:  2.94; xent: 1.08; lr: 0.00103; 26331/24836 tok/s;   9578 sec
[2021-02-19 16:58:18,112 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 16:58:25,886 INFO] number of examples: 410180
[2021-02-19 16:58:35,465 INFO] Step 7500/202000; acc:  72.56; ppl:  2.91; xent: 1.07; lr: 0.00102; 25975/24611 tok/s;   9705 sec
[2021-02-19 16:58:35,466 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 16:58:35,561 INFO] number of examples: 6594
[2021-02-19 16:58:44,786 INFO] Validation perplexity: 3.86712
[2021-02-19 16:58:44,786 INFO] Validation accuracy: 71.0999
[2021-02-19 16:58:44,786 INFO] Model is improving acc: 70.756 --> 71.0999.
[2021-02-19 16:58:44,786 INFO] Model is improving ppl: 3.91122 --> 3.86712.
[2021-02-19 16:58:45,010 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_7500.pt
[2021-02-19 17:00:53,865 INFO] Step 7600/202000; acc:  72.47; ppl:  2.92; xent: 1.07; lr: 0.00101; 23981/22562 tok/s;   9844 sec
[2021-02-19 17:03:00,989 INFO] Step 7700/202000; acc:  72.56; ppl:  2.90; xent: 1.07; lr: 0.00101; 26030/24584 tok/s;   9971 sec
[2021-02-19 17:05:08,563 INFO] Step 7800/202000; acc:  72.73; ppl:  2.88; xent: 1.06; lr: 0.00100; 25958/24584 tok/s;  10098 sec
[2021-02-19 17:05:11,278 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 17:05:33,463 INFO] number of examples: 878269
[2021-02-19 17:07:15,315 INFO] Step 7900/202000; acc:  72.80; ppl:  2.87; xent: 1.05; lr: 0.00099; 26277/24786 tok/s;  10225 sec
[2021-02-19 17:09:22,402 INFO] Step 8000/202000; acc:  72.65; ppl:  2.88; xent: 1.06; lr: 0.00099; 26287/24812 tok/s;  10352 sec
[2021-02-19 17:09:22,403 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 17:09:22,506 INFO] number of examples: 6594
[2021-02-19 17:09:31,757 INFO] Validation perplexity: 3.83669
[2021-02-19 17:09:31,757 INFO] Validation accuracy: 71.166
[2021-02-19 17:09:31,757 INFO] Model is improving acc: 71.0999 --> 71.166.
[2021-02-19 17:09:31,757 INFO] Model is improving ppl: 3.86712 --> 3.83669.
[2021-02-19 17:09:31,979 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_8000.pt
[2021-02-19 17:11:39,760 INFO] Step 8100/202000; acc:  73.04; ppl:  2.83; xent: 1.04; lr: 0.00098; 24382/22713 tok/s;  10489 sec
[2021-02-19 17:13:46,839 INFO] Step 8200/202000; acc:  72.97; ppl:  2.84; xent: 1.04; lr: 0.00098; 26239/24742 tok/s;  10616 sec
[2021-02-19 17:15:54,342 INFO] Step 8300/202000; acc:  72.82; ppl:  2.86; xent: 1.05; lr: 0.00097; 26112/25000 tok/s;  10744 sec
[2021-02-19 17:18:00,811 INFO] Step 8400/202000; acc:  72.92; ppl:  2.84; xent: 1.04; lr: 0.00096; 26309/24806 tok/s;  10870 sec
[2021-02-19 17:19:40,514 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 17:19:47,923 INFO] number of examples: 410180
[2021-02-19 17:20:08,071 INFO] Step 8500/202000; acc:  73.15; ppl:  2.81; xent: 1.03; lr: 0.00096; 25955/24606 tok/s;  10998 sec
[2021-02-19 17:20:08,072 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 17:20:08,124 INFO] number of examples: 6594
[2021-02-19 17:20:17,384 INFO] Validation perplexity: 3.81094
[2021-02-19 17:20:17,384 INFO] Validation accuracy: 71.3153
[2021-02-19 17:20:17,384 INFO] Model is improving acc: 71.166 --> 71.3153.
[2021-02-19 17:20:17,384 INFO] Model is improving ppl: 3.83669 --> 3.81094.
[2021-02-19 17:20:17,607 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_8500.pt
[2021-02-19 17:22:26,486 INFO] Step 8600/202000; acc:  73.16; ppl:  2.81; xent: 1.03; lr: 0.00095; 23965/22514 tok/s;  11136 sec
[2021-02-19 17:24:33,549 INFO] Step 8700/202000; acc:  73.14; ppl:  2.81; xent: 1.03; lr: 0.00095; 26035/24593 tok/s;  11263 sec
[2021-02-19 17:26:33,371 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 17:26:40,791 INFO] Step 8800/202000; acc:  73.29; ppl:  2.79; xent: 1.03; lr: 0.00094; 26062/24670 tok/s;  11390 sec
[2021-02-19 17:26:55,937 INFO] number of examples: 878269
[2021-02-19 17:28:47,555 INFO] Step 8900/202000; acc:  73.36; ppl:  2.78; xent: 1.02; lr: 0.00094; 26313/24829 tok/s;  11517 sec
[2021-02-19 17:30:54,951 INFO] Step 9000/202000; acc:  73.25; ppl:  2.79; xent: 1.03; lr: 0.00093; 26225/24727 tok/s;  11645 sec
[2021-02-19 17:30:54,952 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 17:30:55,053 INFO] number of examples: 6594
[2021-02-19 17:31:04,295 INFO] Validation perplexity: 3.8033
[2021-02-19 17:31:04,295 INFO] Validation accuracy: 71.4166
[2021-02-19 17:31:04,295 INFO] Model is improving acc: 71.3153 --> 71.4166.
[2021-02-19 17:31:04,295 INFO] Model is improving ppl: 3.81094 --> 3.8033.
[2021-02-19 17:31:04,517 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_9000.pt
[2021-02-19 17:33:12,420 INFO] Step 9100/202000; acc:  73.58; ppl:  2.75; xent: 1.01; lr: 0.00093; 24313/22724 tok/s;  11782 sec
[2021-02-19 17:35:19,641 INFO] Step 9200/202000; acc:  73.42; ppl:  2.77; xent: 1.02; lr: 0.00092; 26250/24742 tok/s;  11909 sec
[2021-02-19 17:37:26,619 INFO] Step 9300/202000; acc:  73.46; ppl:  2.76; xent: 1.02; lr: 0.00092; 26239/25065 tok/s;  12036 sec
[2021-02-19 17:39:33,200 INFO] Step 9400/202000; acc:  73.46; ppl:  2.76; xent: 1.01; lr: 0.00091; 26286/24792 tok/s;  12163 sec
[2021-02-19 17:41:02,554 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 17:41:09,838 INFO] number of examples: 410180
[2021-02-19 17:41:40,461 INFO] Step 9500/202000; acc:  73.64; ppl:  2.74; xent: 1.01; lr: 0.00091; 25954/24624 tok/s;  12290 sec
[2021-02-19 17:41:40,462 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 17:41:40,514 INFO] number of examples: 6594
[2021-02-19 17:41:49,821 INFO] Validation perplexity: 3.7962
[2021-02-19 17:41:49,821 INFO] Validation accuracy: 71.4596
[2021-02-19 17:41:49,821 INFO] Model is improving acc: 71.4166 --> 71.4596.
[2021-02-19 17:41:49,821 INFO] Model is improving ppl: 3.8033 --> 3.7962.
[2021-02-19 17:41:50,042 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_9500.pt
[2021-02-19 17:43:58,583 INFO] Step 9600/202000; acc:  73.62; ppl:  2.74; xent: 1.01; lr: 0.00090; 23973/22493 tok/s;  12428 sec
[2021-02-19 17:46:05,339 INFO] Step 9700/202000; acc:  73.69; ppl:  2.73; xent: 1.00; lr: 0.00090; 26110/24704 tok/s;  12555 sec
[2021-02-19 17:47:54,687 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 17:48:12,200 INFO] Step 9800/202000; acc:  73.87; ppl:  2.71; xent: 1.00; lr: 0.00089; 26140/24741 tok/s;  12682 sec
[2021-02-19 17:48:13,954 INFO] number of examples: 878269
[2021-02-19 17:50:19,284 INFO] Step 9900/202000; acc:  73.86; ppl:  2.71; xent: 1.00; lr: 0.00089; 26257/24778 tok/s;  12809 sec
[2021-02-19 17:52:26,404 INFO] Step 10000/202000; acc:  73.78; ppl:  2.71; xent: 1.00; lr: 0.00088; 26316/24731 tok/s;  12936 sec
[2021-02-19 17:52:26,405 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 17:52:26,502 INFO] number of examples: 6594
[2021-02-19 17:52:35,733 INFO] Validation perplexity: 3.81782
[2021-02-19 17:52:35,734 INFO] Validation accuracy: 71.3147
[2021-02-19 17:52:35,734 INFO] Decreasing patience: 4/5
[2021-02-19 17:52:35,954 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_10000.pt
[2021-02-19 17:54:43,849 INFO] Step 10100/202000; acc:  74.06; ppl:  2.68; xent: 0.98; lr: 0.00088; 24278/22784 tok/s;  13073 sec
[2021-02-19 17:56:51,423 INFO] Step 10200/202000; acc:  73.83; ppl:  2.71; xent: 1.00; lr: 0.00088; 26190/24687 tok/s;  13201 sec
[2021-02-19 17:58:58,254 INFO] Step 10300/202000; acc:  74.00; ppl:  2.69; xent: 0.99; lr: 0.00087; 26285/25044 tok/s;  13328 sec
[2021-02-19 18:01:04,746 INFO] Step 10400/202000; acc:  74.00; ppl:  2.68; xent: 0.99; lr: 0.00087; 26280/24849 tok/s;  13454 sec
[2021-02-19 18:02:23,745 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 18:02:34,116 INFO] number of examples: 410180
[2021-02-19 18:03:11,800 INFO] Step 10500/202000; acc:  74.10; ppl:  2.67; xent: 0.98; lr: 0.00086; 26011/24621 tok/s;  13581 sec
[2021-02-19 18:03:11,801 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:03:11,854 INFO] number of examples: 6594
[2021-02-19 18:03:21,159 INFO] Validation perplexity: 3.78925
[2021-02-19 18:03:21,159 INFO] Validation accuracy: 71.4887
[2021-02-19 18:03:21,159 INFO] Model is improving acc: 71.4596 --> 71.4887.
[2021-02-19 18:03:21,159 INFO] Model is improving ppl: 3.7962 --> 3.78925.
[2021-02-19 18:03:21,382 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_10500.pt
[2021-02-19 18:05:30,042 INFO] Step 10600/202000; acc:  74.11; ppl:  2.67; xent: 0.98; lr: 0.00086; 23900/22439 tok/s;  13720 sec
[2021-02-19 18:07:37,152 INFO] Step 10700/202000; acc:  74.19; ppl:  2.66; xent: 0.98; lr: 0.00085; 26062/24685 tok/s;  13847 sec
[2021-02-19 18:09:16,722 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 18:09:35,770 INFO] number of examples: 878269
[2021-02-19 18:09:44,520 INFO] Step 10800/202000; acc:  74.33; ppl:  2.64; xent: 0.97; lr: 0.00085; 26087/24658 tok/s;  13974 sec
[2021-02-19 18:11:51,761 INFO] Step 10900/202000; acc:  74.27; ppl:  2.65; xent: 0.97; lr: 0.00085; 26167/24707 tok/s;  14101 sec
[2021-02-19 18:13:59,082 INFO] Step 11000/202000; acc:  74.26; ppl:  2.65; xent: 0.97; lr: 0.00084; 26341/24752 tok/s;  14229 sec
[2021-02-19 18:13:59,083 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:13:59,185 INFO] number of examples: 6594
[2021-02-19 18:14:08,415 INFO] Validation perplexity: 3.76076
[2021-02-19 18:14:08,416 INFO] Validation accuracy: 71.5512
[2021-02-19 18:14:08,416 INFO] Model is improving acc: 71.4887 --> 71.5512.
[2021-02-19 18:14:08,416 INFO] Model is improving ppl: 3.78925 --> 3.76076.
[2021-02-19 18:14:08,635 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_11000.pt
[2021-02-19 18:16:17,366 INFO] Step 11100/202000; acc:  74.54; ppl:  2.62; xent: 0.96; lr: 0.00084; 24097/22591 tok/s;  14367 sec
[2021-02-19 18:18:24,759 INFO] Step 11200/202000; acc:  74.27; ppl:  2.65; xent: 0.97; lr: 0.00084; 26235/24789 tok/s;  14494 sec
[2021-02-19 18:20:31,284 INFO] Step 11300/202000; acc:  74.46; ppl:  2.62; xent: 0.96; lr: 0.00083; 26323/25036 tok/s;  14621 sec
[2021-02-19 18:22:38,186 INFO] Step 11400/202000; acc:  74.39; ppl:  2.63; xent: 0.97; lr: 0.00083; 26222/24767 tok/s;  14748 sec
[2021-02-19 18:23:46,931 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 18:23:57,152 INFO] number of examples: 410180
[2021-02-19 18:24:45,182 INFO] Step 11500/202000; acc:  74.56; ppl:  2.61; xent: 0.96; lr: 0.00082; 26009/24627 tok/s;  14875 sec
[2021-02-19 18:24:45,182 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:24:45,234 INFO] number of examples: 6594
[2021-02-19 18:24:54,540 INFO] Validation perplexity: 3.77959
[2021-02-19 18:24:54,540 INFO] Validation accuracy: 71.6309
[2021-02-19 18:24:54,540 INFO] Stalled patience: 4/5
[2021-02-19 18:24:54,766 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_11500.pt
[2021-02-19 18:27:03,357 INFO] Step 11600/202000; acc:  74.51; ppl:  2.61; xent: 0.96; lr: 0.00082; 23898/22529 tok/s;  15013 sec
[2021-02-19 18:29:10,686 INFO] Step 11700/202000; acc:  74.58; ppl:  2.61; xent: 0.96; lr: 0.00082; 26043/24636 tok/s;  15140 sec
[2021-02-19 18:30:39,582 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 18:30:59,337 INFO] number of examples: 878269
[2021-02-19 18:31:17,446 INFO] Step 11800/202000; acc:  74.80; ppl:  2.58; xent: 0.95; lr: 0.00081; 26194/24688 tok/s;  15267 sec
[2021-02-19 18:33:24,694 INFO] Step 11900/202000; acc:  74.68; ppl:  2.59; xent: 0.95; lr: 0.00081; 26210/24787 tok/s;  15394 sec
[2021-02-19 18:35:31,794 INFO] Step 12000/202000; acc:  74.67; ppl:  2.59; xent: 0.95; lr: 0.00081; 26344/24765 tok/s;  15521 sec
[2021-02-19 18:35:31,795 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:35:31,891 INFO] number of examples: 6594
[2021-02-19 18:35:41,151 INFO] Validation perplexity: 3.80493
[2021-02-19 18:35:41,152 INFO] Validation accuracy: 71.6443
[2021-02-19 18:35:41,152 INFO] Stalled patience: 3/5
[2021-02-19 18:35:41,374 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_12000.pt
[2021-02-19 18:37:48,720 INFO] Step 12100/202000; acc:  74.95; ppl:  2.56; xent: 0.94; lr: 0.00080; 24345/22849 tok/s;  15658 sec
[2021-02-19 18:39:56,127 INFO] Step 12200/202000; acc:  74.59; ppl:  2.60; xent: 0.96; lr: 0.00080; 26198/24739 tok/s;  15786 sec
[2021-02-19 18:42:02,962 INFO] Step 12300/202000; acc:  74.90; ppl:  2.57; xent: 0.94; lr: 0.00080; 26316/24999 tok/s;  15913 sec
[2021-02-19 18:44:09,799 INFO] Step 12400/202000; acc:  74.84; ppl:  2.57; xent: 0.94; lr: 0.00079; 26224/24775 tok/s;  16039 sec
[2021-02-19 18:45:08,672 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 18:45:15,750 INFO] number of examples: 410180
[2021-02-19 18:46:17,272 INFO] Step 12500/202000; acc:  74.90; ppl:  2.57; xent: 0.94; lr: 0.00079; 25907/24518 tok/s;  16167 sec
[2021-02-19 18:46:17,273 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:46:17,375 INFO] number of examples: 6594
[2021-02-19 18:46:26,633 INFO] Validation perplexity: 3.77465
[2021-02-19 18:46:26,633 INFO] Validation accuracy: 71.6494
[2021-02-19 18:46:26,633 INFO] Stalled patience: 2/5
[2021-02-19 18:46:26,854 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_12500.pt
[2021-02-19 18:48:35,184 INFO] Step 12600/202000; acc:  74.95; ppl:  2.56; xent: 0.94; lr: 0.00079; 23955/22605 tok/s;  16305 sec
[2021-02-19 18:50:42,495 INFO] Step 12700/202000; acc:  74.92; ppl:  2.56; xent: 0.94; lr: 0.00078; 25990/24646 tok/s;  16432 sec
[2021-02-19 18:52:01,256 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.0.pt
[2021-02-19 18:52:20,848 INFO] number of examples: 878269
[2021-02-19 18:52:49,328 INFO] Step 12800/202000; acc:  75.21; ppl:  2.53; xent: 0.93; lr: 0.00078; 26236/24660 tok/s;  16559 sec
[2021-02-19 18:54:56,785 INFO] Step 12900/202000; acc:  75.06; ppl:  2.55; xent: 0.93; lr: 0.00078; 26182/24629 tok/s;  16686 sec
[2021-02-19 18:57:04,046 INFO] Step 13000/202000; acc:  75.07; ppl:  2.54; xent: 0.93; lr: 0.00078; 26297/24784 tok/s;  16814 sec
[2021-02-19 18:57:04,047 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 18:57:04,097 INFO] number of examples: 6594
[2021-02-19 18:57:13,350 INFO] Validation perplexity: 3.76762
[2021-02-19 18:57:13,350 INFO] Validation accuracy: 71.6387
[2021-02-19 18:57:13,350 INFO] Stalled patience: 1/5
[2021-02-19 18:57:13,571 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_13000.pt
[2021-02-19 18:59:21,329 INFO] Step 13100/202000; acc:  75.32; ppl:  2.51; xent: 0.92; lr: 0.00077; 24271/22842 tok/s;  16951 sec
[2021-02-19 19:01:29,047 INFO] Step 13200/202000; acc:  75.00; ppl:  2.55; xent: 0.94; lr: 0.00077; 26115/24674 tok/s;  17079 sec
[2021-02-19 19:03:35,805 INFO] Step 13300/202000; acc:  75.20; ppl:  2.53; xent: 0.93; lr: 0.00077; 26245/24991 tok/s;  17205 sec
[2021-02-19 19:05:42,771 INFO] Step 13400/202000; acc:  75.22; ppl:  2.53; xent: 0.93; lr: 0.00076; 26288/24785 tok/s;  17332 sec
[2021-02-19 19:06:31,306 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.train.1.pt
[2021-02-19 19:06:42,395 INFO] number of examples: 410180
[2021-02-19 19:07:50,129 INFO] Step 13500/202000; acc:  75.31; ppl:  2.52; xent: 0.92; lr: 0.00076; 25933/24511 tok/s;  17460 sec
[2021-02-19 19:07:50,130 INFO] Loading dataset from /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/data/ready_to_train.valid.0.pt
[2021-02-19 19:07:50,227 INFO] number of examples: 6594
[2021-02-19 19:07:59,502 INFO] Validation perplexity: 3.76703
[2021-02-19 19:07:59,502 INFO] Validation accuracy: 71.663
[2021-02-19 19:07:59,502 INFO] Stalled patience: 0/5
[2021-02-19 19:07:59,502 INFO] Training finished after stalled validations. Early Stop!
[2021-02-19 19:07:59,502 INFO] Best model found at step 11000
[2021-02-19 19:07:59,726 INFO] Saving checkpoint /home/shterion/EcoNMT/engines/FR-EN-TRANS-BPE/model/model_step_13500.pt
